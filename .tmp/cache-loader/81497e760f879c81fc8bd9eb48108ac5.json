{"remainingRequest":"/home/vps/ppf/node_modules/babel-loader/lib/index.js??ref--13-2!/home/vps/ppf/src/apps/client/ui/components/TransactionInfoPopup/TransactionInfoPopup.jsx","dependencies":[{"path":"/home/vps/ppf/src/apps/client/ui/components/TransactionInfoPopup/TransactionInfoPopup.jsx","mtime":1671127663529},{"path":"/home/vps/ppf/.babelrc","mtime":1671127885972},{"path":"/home/vps/ppf/node_modules/cache-loader/dist/cjs.js","mtime":1671127657171},{"path":"/home/vps/ppf/node_modules/babel-loader/lib/index.js","mtime":1671127654997}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class, _temp, _React$createElement23;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _format = require('date-fns/format');\n\nvar _format2 = _interopRequireDefault(_format);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _TransactionInfoPopup = require('./TransactionInfoPopup.css');\n\nvar _TransactionInfoPopup2 = _interopRequireDefault(_TransactionInfoPopup);\n\nvar _propOr = require('@tinkoff/utils/object/propOr');\n\nvar _propOr2 = _interopRequireDefault(_propOr);\n\nvar _pathOr = require('@tinkoff/utils/object/pathOr');\n\nvar _pathOr2 = _interopRequireDefault(_pathOr);\n\nvar _undefined = require('@tinkoff/utils/is/undefined');\n\nvar _undefined2 = _interopRequireDefault(_undefined);\n\nvar _object = require('@tinkoff/utils/is/object');\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _array = require('@tinkoff/utils/is/array');\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _required = require('../Form/validators/required');\n\nvar _required2 = _interopRequireDefault(_required);\n\nvar _setAccountInfoPopup2 = require('../../../actions/setAccountInfoPopup');\n\nvar _setAccountInfoPopup3 = _interopRequireDefault(_setAccountInfoPopup2);\n\nvar _setWithdrawSuccessPopup2 = require('../../../actions/setWithdrawSuccessPopup');\n\nvar _setWithdrawSuccessPopup3 = _interopRequireDefault(_setWithdrawSuccessPopup2);\n\nvar _saveTransaction2 = require('../../../services/client/saveTransaction');\n\nvar _saveTransaction3 = _interopRequireDefault(_saveTransaction2);\n\nvar _saveMoneyOutput2 = require('../../../services/client/saveMoneyOutput');\n\nvar _saveMoneyOutput3 = _interopRequireDefault(_saveMoneyOutput2);\n\nvar _FormInput = require('../FormInput/FormInput');\n\nvar _FormInput2 = _interopRequireDefault(_FormInput);\n\nvar _checkBalance = require('../../../../../../server/api/admin/transaction/utils/checkBalance');\n\nvar _checkBalance2 = _interopRequireDefault(_checkBalance);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mapStateToProps = function mapStateToProps(_ref) {\n    var application = _ref.application,\n        data = _ref.data;\n\n    return {\n        langMap: application.langMap,\n        transactions: data.transactions,\n        user: data.user\n    };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n    return {\n        saveMoneyOutput: function saveMoneyOutput(payload) {\n            return dispatch((0, _saveMoneyOutput3.default)(payload));\n        },\n        saveTransaction: function saveTransaction(payload) {\n            return dispatch((0, _saveTransaction3.default)(payload));\n        },\n        setAccountInfoPopup: function setAccountInfoPopup(payload) {\n            return dispatch((0, _setAccountInfoPopup3.default)(payload));\n        },\n        setWithdrawSuccessPopup: function setWithdrawSuccessPopup(payload) {\n            return dispatch((0, _setWithdrawSuccessPopup3.default)(payload));\n        }\n    };\n};\n\nvar _ref2 = _react2.default.createElement('img', (_React$createElement23 = { src: '/src/apps/client/ui/components/ConfirmPopup/img/info.svg', alt: 'info', 'data-qa-file': 'TransactionInfoPopup'\n}, (0, _defineProperty3.default)(_React$createElement23, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement23, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement23));\n\nvar TransactionInfoPopup = (_temp = _class = function (_Component) {\n    (0, _inherits3.default)(TransactionInfoPopup, _Component);\n\n    function TransactionInfoPopup(props) {\n        (0, _classCallCheck3.default)(this, TransactionInfoPopup);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (TransactionInfoPopup.__proto__ || Object.getPrototypeOf(TransactionInfoPopup)).call(this, props));\n\n        _this.handleChange = function (name, value) {\n            return function (e) {\n                var _this$setState;\n\n                e.stopPropagation();\n                var actualValue = (0, _undefined2.default)(value) ? e.target.value : value;\n\n                if (actualValue.length > _this.state.maxLength) return;\n\n                _this.setState((_this$setState = {}, (0, _defineProperty3.default)(_this$setState, name, (0, _extends3.default)({}, _this.state[name], { value: actualValue, focus: (0, _undefined2.default)(value), isValid: true })), (0, _defineProperty3.default)(_this$setState, 'error', ''), _this$setState));\n            };\n        };\n\n        _this.onFocus = function (name) {\n            return function (e) {\n                e.stopPropagation();\n                _this.setState((0, _defineProperty3.default)({}, name, (0, _extends3.default)({}, _this.state[name], { focus: !_this.state[name].focus })));\n            };\n        };\n\n        _this.onBlur = function (name) {\n            var currentState = _this.handleCheckErrors([name]);\n\n            _this.setState((0, _defineProperty3.default)({}, name, (0, _extends3.default)({}, _this.state[name], { focus: false, isValid: currentState[name].isValid })));\n        };\n\n        _this.handleCheckErrors = function () {\n            var names = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n            var thisState = {};\n            _this.setState({\n                error: ''\n            });\n\n            names.forEach(function (name) {\n                var property = _this.state[name];\n\n                if ((0, _object2.default)(property) && !(0, _array2.default)(property)) {\n                    var _this$setState4;\n\n                    var isValid = true;\n                    var error = void 0;\n\n                    if (_this.state[name].value < 5 && !!_this.state[name].value || !_this.state[name].value) {\n                        error = 'MinValue';\n                    } else if (!(0, _checkBalance2.default)(_this.props.user.balance - _this.state[name].value) && !!_this.state[name].value) {\n                        error = 'Balance';\n                    }\n\n                    if (error) {\n                        isValid = false;\n                    }\n\n                    var newValue = (0, _extends3.default)({}, property, { isValid: isValid });\n                    thisState[name] = newValue;\n\n                    _this.setState((_this$setState4 = {}, (0, _defineProperty3.default)(_this$setState4, name, newValue), (0, _defineProperty3.default)(_this$setState4, 'error', error), _this$setState4));\n                }\n            });\n\n            return thisState;\n        };\n\n        _this.handleSubmit = function (e) {\n            e.preventDefault();\n\n            var amount = _this.state.amount;\n\n\n            var thisState = _this.handleCheckErrors(Object.keys(_this.state));\n            var isValid = (0, _required2.default)(amount.value, { text: false }) === undefined;\n\n            for (var key in thisState) {\n                if (!(0, _pathOr2.default)(['isValid'], true, thisState[key])) {\n                    isValid = false;\n                }\n            }\n\n            if (isValid) {\n                _this.props.saveMoneyOutput({\n                    userId: _this.props.user.id,\n                    amount: amount.value\n                }).then(function () {\n                    _this.props.setWithdrawSuccessPopup({ visible: true, amount: amount.value });\n                    setTimeout(function () {\n                        return _this.closePopup();\n                    }, 2000);\n                }).catch(function (e) {\n                    _this.setState({ error: e.message });\n                });\n            }\n        };\n\n        _this.closePopup = function () {\n            _this.props.setWithdrawSuccessPopup({ visible: false, amount: _this.state.amount.value });\n            _this.props.setAccountInfoPopup();\n        };\n\n        _this.getDate = function (currentDate) {\n            var date = new Date(currentDate);\n            return (0, _format2.default)(date, 'dd.MM.yyyy HH:mm');\n        };\n\n        _this.state = (0, _extends3.default)({}, _this.defaultState(), {\n            error: ''\n        });\n        return _this;\n    }\n\n    (0, _createClass3.default)(TransactionInfoPopup, [{\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps) {\n            if (prevProps.isVisible !== this.props.isVisible && !this.props.isVisible) {\n                this.setState((0, _extends3.default)({}, this.defaultState(), {\n                    error: ''\n                }));\n            }\n        }\n    }, {\n        key: 'defaultState',\n        value: function defaultState() {\n            return {\n                amount: { value: '', focus: false, isValid: true }\n            };\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _React$createElement,\n                _React$createElement2,\n                _React$createElement3,\n                _React$createElement4,\n                _React$createElement5,\n                _this2 = this,\n                _React$createElement11,\n                _React$createElement12,\n                _React$createElement13,\n                _React$createElement14,\n                _React$createElement15,\n                _React$createElement16,\n                _React$createElement17,\n                _React$createElement18,\n                _React$createElement19,\n                _React$createElement20,\n                _React$createElement21,\n                _React$createElement22;\n\n            var _props = this.props,\n                langMap = _props.langMap,\n                transactions = _props.transactions;\n            var error = this.state.error;\n\n            var text = (0, _propOr2.default)('accountInfo', {}, langMap).transaction;\n\n            return _react2.default.createElement(\n                'div',\n                (_React$createElement22 = { className: _TransactionInfoPopup2.default.transactionPopupContainer, 'data-qa-file': 'TransactionInfoPopup'\n                }, (0, _defineProperty3.default)(_React$createElement22, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement22, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement22),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement5 = { className: _TransactionInfoPopup2.default.navbar, 'data-qa-file': 'TransactionInfoPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement5),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement = { className: _TransactionInfoPopup2.default.itemNum, 'data-qa-file': 'TransactionInfoPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement),\n                        '#'\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement2 = { className: _TransactionInfoPopup2.default.itemSum, 'data-qa-file': 'TransactionInfoPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement2),\n                        text.summ\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement3 = { className: _TransactionInfoPopup2.default.itemStatus, 'data-qa-file': 'TransactionInfoPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement3),\n                        text.status\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement4 = { className: _TransactionInfoPopup2.default.itemDate, 'data-qa-file': 'TransactionInfoPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement4),\n                        text.date\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement11 = { className: _TransactionInfoPopup2.default.transactionsContainer, 'data-qa-file': 'TransactionInfoPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement11),\n                    transactions.sort(function (prev, next) {\n                        return next.createdAt - prev.createdAt;\n                    }).map(function (item, i) {\n                        var _React$createElement6, _React$createElement7, _React$createElement8, _React$createElement9, _React$createElement10;\n\n                        return _react2.default.createElement(\n                            'div',\n                            (_React$createElement10 = { key: i, className: _TransactionInfoPopup2.default.transactionItem, 'data-qa-file': 'TransactionInfoPopup'\n                            }, (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement10),\n                            _react2.default.createElement(\n                                'div',\n                                (_React$createElement6 = { className: _TransactionInfoPopup2.default.itemNum, 'data-qa-file': 'TransactionInfoPopup'\n                                }, (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement6),\n                                i + 1\n                            ),\n                            _react2.default.createElement(\n                                'div',\n                                (_React$createElement7 = { className: _TransactionInfoPopup2.default.itemSum, 'data-qa-file': 'TransactionInfoPopup'\n                                }, (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement7),\n                                '$ ',\n                                item.value\n                            ),\n                            _react2.default.createElement(\n                                'div',\n                                (_React$createElement8 = { className: _TransactionInfoPopup2.default.itemStatus, 'data-qa-file': 'TransactionInfoPopup'\n                                }, (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement8),\n                                item.content\n                            ),\n                            _react2.default.createElement(\n                                'div',\n                                (_React$createElement9 = { className: _TransactionInfoPopup2.default.itemDate, 'data-qa-file': 'TransactionInfoPopup'\n                                }, (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement9),\n                                _this2.getDate(item.createdAt)\n                            )\n                        );\n                    })\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement21 = { className: _TransactionInfoPopup2.default.footer, 'data-qa-file': 'TransactionInfoPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement21, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement21, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement21),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement12 = { className: _TransactionInfoPopup2.default.funds, 'data-qa-file': 'TransactionInfoPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement12, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement12, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement12),\n                        text.moneyWithdrawalTitle\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement20 = { className: _TransactionInfoPopup2.default.rightContainer, 'data-qa-file': 'TransactionInfoPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement20, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement20, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement20),\n                        _react2.default.createElement(\n                            'div',\n                            (_React$createElement13 = { className: _TransactionInfoPopup2.default.summ, 'data-qa-file': 'TransactionInfoPopup'\n                            }, (0, _defineProperty3.default)(_React$createElement13, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement13, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement13),\n                            text.summ,\n                            ', $'\n                        ),\n                        _react2.default.createElement(\n                            'form',\n                            (_React$createElement19 = { className: _TransactionInfoPopup2.default.form, onSubmit: this.handleSubmit, 'data-qa-file': 'TransactionInfoPopup'\n                            }, (0, _defineProperty3.default)(_React$createElement19, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement19, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement19),\n                            _react2.default.createElement(\n                                'div',\n                                (_React$createElement15 = { className: _TransactionInfoPopup2.default.amountContainerField, 'data-qa-file': 'TransactionInfoPopup'\n                                }, (0, _defineProperty3.default)(_React$createElement15, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement15, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement15),\n                                _react2.default.createElement(_FormInput2.default, (_React$createElement14 = {\n                                    texts: { amount: text.inputPlaceholder },\n                                    name: 'amount',\n                                    onFocus: this.onFocus,\n                                    onBlur: this.onBlur,\n                                    handleChange: this.handleChange,\n                                    value: this.state.amount.value,\n                                    focus: this.state.amount.value,\n                                    type: 'number',\n                                    'data-qa-file': 'TransactionInfoPopup'\n                                }, (0, _defineProperty3.default)(_React$createElement14, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement14, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement14))\n                            ),\n                            _react2.default.createElement(\n                                'button',\n                                (_React$createElement18 = { type: 'submit', className: (0, _classnames2.default)(_TransactionInfoPopup2.default.button, (0, _defineProperty3.default)({}, _TransactionInfoPopup2.default.buttonUnactive, !this.state['amount'].isValid || error)), 'data-qa-file': 'TransactionInfoPopup'\n                                }, (0, _defineProperty3.default)(_React$createElement18, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement18, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement18),\n                                text.moneyWithdrawal,\n                                _react2.default.createElement(\n                                    'div',\n                                    (_React$createElement17 = { className: (0, _classnames2.default)(_TransactionInfoPopup2.default.failedPopup, (0, _defineProperty3.default)({}, _TransactionInfoPopup2.default.isFailedPopup, !this.state['amount'].isValid || error)), 'data-qa-file': 'TransactionInfoPopup'\n                                    }, (0, _defineProperty3.default)(_React$createElement17, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement17, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement17),\n                                    _ref2,\n                                    _react2.default.createElement(\n                                        'div',\n                                        (_React$createElement16 = { className: _TransactionInfoPopup2.default.title, 'data-qa-file': 'TransactionInfoPopup'\n                                        }, (0, _defineProperty3.default)(_React$createElement16, 'data-qa-file', 'TransactionInfoPopup'), (0, _defineProperty3.default)(_React$createElement16, 'data-qa-file', 'TransactionInfoPopup'), _React$createElement16),\n                                        text.error['failed' + (!this.state['amount'].isValid || error ? error : '')]\n                                    )\n                                )\n                            )\n                        )\n                    )\n                )\n            );\n        }\n    }]);\n    return TransactionInfoPopup;\n}(_react.Component), _class.defaultProps = {\n    transactions: []\n}, _temp);\nexports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(TransactionInfoPopup);",null]}