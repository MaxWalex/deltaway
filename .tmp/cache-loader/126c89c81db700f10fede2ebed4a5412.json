{"remainingRequest":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/babel-loader/lib/index.js??ref--13-2!/Users/dimasabitov/Downloads/deltaway.20/src/apps/client/ui/components/AuthFormPopup/AuthFormPopup.jsx","dependencies":[{"path":"/Users/dimasabitov/Downloads/deltaway.20/src/apps/client/ui/components/AuthFormPopup/AuthFormPopup.jsx","mtime":1671546489586},{"path":"/Users/dimasabitov/Downloads/deltaway.20/.babelrc","mtime":1671546158632},{"path":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/cache-loader/dist/cjs.js","mtime":1671546959174},{"path":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/babel-loader/lib/index.js","mtime":1671546957682}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends3 = require('babel-runtime/helpers/extends');\n\nvar _extends4 = _interopRequireDefault(_extends3);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class,\n    _temp,\n    _jsxFileName = '/Users/dimasabitov/Downloads/deltaway.20/src/apps/client/ui/components/AuthFormPopup/AuthFormPopup.jsx';\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _undefined = require('@tinkoff/utils/is/undefined');\n\nvar _undefined2 = _interopRequireDefault(_undefined);\n\nvar _object = require('@tinkoff/utils/is/object');\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _array = require('@tinkoff/utils/is/array');\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _required = require('../Form/validators/required');\n\nvar _required2 = _interopRequireDefault(_required);\n\nvar _email = require('../Form/validators/email');\n\nvar _email2 = _interopRequireDefault(_email);\n\nvar _pathOr = require('@tinkoff/utils/object/pathOr');\n\nvar _pathOr2 = _interopRequireDefault(_pathOr);\n\nvar _FormInput = require('../FormInput/FormInput');\n\nvar _FormInput2 = _interopRequireDefault(_FormInput);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _AuthFormPopup = require('./AuthFormPopup.css');\n\nvar _AuthFormPopup2 = _interopRequireDefault(_AuthFormPopup);\n\nvar _propOr = require('@tinkoff/utils/object/propOr');\n\nvar _propOr2 = _interopRequireDefault(_propOr);\n\nvar _ResetPasswordFormPopup = require('../ResetPasswordFormPopup/ResetPasswordFormPopup');\n\nvar _ResetPasswordFormPopup2 = _interopRequireDefault(_ResetPasswordFormPopup);\n\nvar _logIn2 = require('../../../services/client/logIn');\n\nvar _logIn3 = _interopRequireDefault(_logIn2);\n\nvar _checkAuthentication2 = require('../../../services/client/checkAuthentication');\n\nvar _checkAuthentication3 = _interopRequireDefault(_checkAuthentication2);\n\nvar _setAuthenticationPopup2 = require('../../../actions/setAuthenticationPopup');\n\nvar _setAuthenticationPopup3 = _interopRequireDefault(_setAuthenticationPopup2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mapStateToProps = function mapStateToProps(_ref) {\n    var application = _ref.application;\n\n    return {\n        langMap: application.langMap\n    };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n    return {\n        logIn: function logIn(payload) {\n            return dispatch((0, _logIn3.default)(payload));\n        },\n        setAuthenticationPopup: function setAuthenticationPopup(payload) {\n            return dispatch((0, _setAuthenticationPopup3.default)(payload));\n        },\n        checkAuthentication: function checkAuthentication(payload) {\n            return dispatch((0, _checkAuthentication3.default)(payload));\n        }\n    };\n};\n\nvar AuthFormPopup = (_temp = _class = function (_Component) {\n    (0, _inherits3.default)(AuthFormPopup, _Component);\n\n    function AuthFormPopup(props) {\n        (0, _classCallCheck3.default)(this, AuthFormPopup);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (AuthFormPopup.__proto__ || Object.getPrototypeOf(AuthFormPopup)).call(this, props));\n\n        _this.handleChange = function (name, value) {\n            return function (e) {\n                e.stopPropagation();\n                var actualValue = (0, _undefined2.default)(value) ? e.target.value : value;\n\n                if (actualValue.length > _this.state.maxLength) return;\n\n                _this.setState((0, _defineProperty3.default)({}, name, (0, _extends4.default)({}, _this.state[name], { value: actualValue, focus: (0, _undefined2.default)(value), isValid: true })));\n            };\n        };\n\n        _this.onFocus = function (name) {\n            return function (e) {\n                e.stopPropagation();\n                _this.setState((0, _defineProperty3.default)({}, name, (0, _extends4.default)({}, _this.state[name], { focus: !_this.state[name].focus })));\n            };\n        };\n\n        _this.onBlur = function (name) {\n            var currentState = _this.handleCheckErrors([name]);\n\n            _this.setState((0, _defineProperty3.default)({}, name, (0, _extends4.default)({}, _this.state[name], { focus: false, isValid: currentState[name].isValid })));\n        };\n\n        _this.handleCheckErrors = function () {\n            var names = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n            var thisState = {};\n\n            names.forEach(function (name) {\n                var property = _this.state[name];\n\n                if ((0, _object2.default)(property) && !(0, _array2.default)(property)) {\n                    var value = _this.state[name].value;\n                    var isValid = (name === 'email' ? (0, _email2.default)(value, { text: false }) : (0, _required2.default)(value, { text: false })) === undefined;\n\n                    var newValue = (0, _extends4.default)({}, property, { isValid: isValid });\n                    thisState[name] = newValue;\n\n                    _this.setState((0, _defineProperty3.default)({}, name, newValue));\n                }\n            });\n\n            return thisState;\n        };\n\n        _this.handleSubmit = function (e) {\n            e.preventDefault();\n\n            var _this$state = _this.state,\n                email = _this$state.email,\n                password = _this$state.password;\n\n\n            var thisState = _this.handleCheckErrors(Object.keys(_this.state));\n            var isValid = true;\n\n            for (var key in thisState) {\n                if (!(0, _pathOr2.default)(['isValid'], true, thisState[key])) {\n                    isValid = false;\n                }\n            }\n\n            if (isValid) {\n                var credentials = {\n                    email: email.value.trim(),\n                    password: password.value.trim()\n                };\n\n                _this.props.logIn(credentials).then(function () {\n                    _this.setState((0, _extends4.default)({}, _this.defaultState(), {\n                        isForgetPassword: false\n\n                    }));\n                    _this.props.checkAuthentication();\n                    _this.closePopup();\n                }).catch(function (e) {\n                    return _this.setState({ error: e.message });\n                });\n            }\n        };\n\n        _this.closePopup = function () {\n            _this.props.setAuthenticationPopup(false);\n        };\n\n        _this.handleForgetPassword = function () {\n            _this.setState({\n                isForgetPassword: !_this.state.isForgetPassword\n            });\n        };\n\n        _this.handlerShowPassword = function () {\n            _this.setState({ isPasswordShown: !_this.state.isPasswordShown });\n        };\n\n        _this.state = (0, _extends4.default)({}, _this.defaultState(), {\n            isForgetPassword: false,\n            isPasswordShown: false\n        });\n        return _this;\n    }\n\n    (0, _createClass3.default)(AuthFormPopup, [{\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps) {\n            if (prevProps.isVisible !== this.props.isVisible && !this.props.isVisible) {\n                this.setState((0, _extends4.default)({}, this.defaultState(), {\n                    isForgetPassword: false\n                }));\n            }\n        }\n    }, {\n        key: 'defaultState',\n        value: function defaultState() {\n            return {\n                email: { value: '', focus: false, isValid: true },\n                password: { value: '', focus: false, isValid: true },\n                error: null\n            };\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _React$createElement, _React$createElement2, _React$createElement3, _React$createElement4, _React$createElement5, _React$createElement6, _React$createElement7, _React$createElement8, _React$createElement9, _React$createElement10, _React$createElement11;\n\n            var langMap = this.props.langMap;\n            var _state = this.state,\n                isForgetPassword = _state.isForgetPassword,\n                isPasswordShown = _state.isPasswordShown,\n                error = _state.error;\n\n            var text = (0, _propOr2.default)('auth', {}, langMap);\n\n            return [_react2.default.createElement(\n                'form',\n                (_React$createElement10 = { key: 0, className: (0, _classnames2.default)(_AuthFormPopup2.default.form, (0, _defineProperty3.default)({}, _AuthFormPopup2.default.isPopupHidden, isForgetPassword)), onSubmit: this.handleSubmit, 'data-qa-file': 'AuthFormPopup',\n                    __source: {\n                        fileName: _jsxFileName,\n                        lineNumber: 176\n                    },\n                    __self: this\n                }, (0, _defineProperty3.default)(_React$createElement10, '__self', this), (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'AuthFormPopup'), _React$createElement10),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement3 = { className: _AuthFormPopup2.default.emailContainerField, 'data-qa-file': 'AuthFormPopup',\n                        __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 179\n                        },\n                        __self: this\n                    }, (0, _defineProperty3.default)(_React$createElement3, '__self', this), (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'AuthFormPopup'), _React$createElement3),\n                    _react2.default.createElement(_FormInput2.default, (_React$createElement = {\n                        isError: !this.state['email'].isValid,\n                        texts: { email: '' + text.inputs.email.placeholder, emailValidator: '' + text.inputs.email.validator },\n                        name: 'email',\n                        type: 'email',\n                        onFocus: this.onFocus,\n                        onBlur: this.onBlur,\n                        handleChange: this.handleChange,\n                        value: this.state.email.value,\n                        focus: this.state.email.value,\n                        'data-qa-file': 'AuthFormPopup',\n                        __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 180\n                        },\n                        __self: this\n                    }, (0, _defineProperty3.default)(_React$createElement, '__self', this), (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'AuthFormPopup'), _React$createElement)),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement2 = { className: (0, _classnames2.default)(_AuthFormPopup2.default.bottomLabel, (0, _defineProperty3.default)({}, _AuthFormPopup2.default.bottomLabelActive, this.state['email'].isValid)), 'data-qa-file': 'AuthFormPopup',\n                            __source: {\n                                fileName: _jsxFileName,\n                                lineNumber: 191\n                            },\n                            __self: this\n                        }, (0, _defineProperty3.default)(_React$createElement2, '__self', this), (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'AuthFormPopup'), _React$createElement2),\n                        text.isLogin\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement5 = { className: _AuthFormPopup2.default.passwordContainerField, 'data-qa-file': 'AuthFormPopup',\n                        __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 195\n                        },\n                        __self: this\n                    }, (0, _defineProperty3.default)(_React$createElement5, '__self', this), (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'AuthFormPopup'), _React$createElement5),\n                    _react2.default.createElement(_FormInput2.default, (0, _extends4.default)({\n                        isError: !this.state['password'].isValid,\n                        texts: { password: '' + text.inputs.password.placeholder, passwordValidator: '' + text.inputs.password.validator },\n                        name: 'password',\n                        onFocus: this.onFocus,\n                        onBlur: this.onBlur,\n                        handleChange: this.handleChange,\n                        value: this.state.password.value,\n                        focus: this.state.password.focus\n                    }, !isPasswordShown && { type: 'password' }, (0, _defineProperty3.default)({\n                        'data-qa-file': 'AuthFormPopup',\n                        __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 196\n                        },\n                        __self: this\n                    }, '__self', this))),\n                    _react2.default.createElement('img', (_React$createElement4 = {\n                        onClick: this.handlerShowPassword,\n                        src: '/src/apps/client/ui/components/AuthFormPopup/images/password.svg',\n                        alt: '',\n                        'data-qa-file': 'AuthFormPopup',\n                        __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 207\n                        },\n                        __self: this\n                    }, (0, _defineProperty3.default)(_React$createElement4, '__self', this), (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'AuthFormPopup'), _React$createElement4))\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement8 = { className: _AuthFormPopup2.default.buttonContainer, 'data-qa-file': 'AuthFormPopup',\n                        __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 213\n                        },\n                        __self: this\n                    }, (0, _defineProperty3.default)(_React$createElement8, '__self', this), (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'AuthFormPopup'), _React$createElement8),\n                    error && _react2.default.createElement(\n                        'div',\n                        (_React$createElement6 = { className: _AuthFormPopup2.default.errorMessage, 'data-qa-file': 'AuthFormPopup',\n                            __source: {\n                                fileName: _jsxFileName,\n                                lineNumber: 214\n                            },\n                            __self: this\n                        }, (0, _defineProperty3.default)(_React$createElement6, '__self', this), (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'AuthFormPopup'), _React$createElement6),\n                        error\n                    ),\n                    _react2.default.createElement(\n                        'button',\n                        (_React$createElement7 = { className: (0, _classnames2.default)(_AuthFormPopup2.default.button), type: 'submit', 'data-qa-file': 'AuthFormPopup',\n                            __source: {\n                                fileName: _jsxFileName,\n                                lineNumber: 215\n                            },\n                            __self: this\n                        }, (0, _defineProperty3.default)(_React$createElement7, '__self', this), (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'AuthFormPopup'), _React$createElement7),\n                        text.signIn\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement9 = { className: _AuthFormPopup2.default.forgetPassordButton, onClick: this.handleForgetPassword, 'data-qa-file': 'AuthFormPopup',\n                        __source: {\n                            fileName: _jsxFileName,\n                            lineNumber: 217\n                        },\n                        __self: this\n                    }, (0, _defineProperty3.default)(_React$createElement9, '__self', this), (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'AuthFormPopup'), _React$createElement9),\n                    text.forgetPassword\n                )\n            ), _react2.default.createElement(_ResetPasswordFormPopup2.default, (_React$createElement11 = { key: 1, isOpen: isForgetPassword, handleBackClick: this.handleForgetPassword, handleClose: this.closePopup, 'data-qa-file': 'AuthFormPopup',\n                __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 219\n                },\n                __self: this\n            }, (0, _defineProperty3.default)(_React$createElement11, '__self', this), (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'AuthFormPopup'), _React$createElement11))];\n        }\n    }]);\n    return AuthFormPopup;\n}(_react.Component), _class.propTypes = {\n    langMap: _propTypes2.default.object.isRequired,\n    logIn: _propTypes2.default.func.isRequired,\n    setAuthenticationPopup: _propTypes2.default.func.isRequired,\n    checkAuthentication: _propTypes2.default.func.isRequired,\n    isVisible: _propTypes2.default.bool.isRequired\n}, _temp);\nexports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(AuthFormPopup);",{"version":3,"sources":["src/apps/client/ui/components/AuthFormPopup/AuthFormPopup.jsx"],"names":["mapStateToProps","application","langMap","mapDispatchToProps","dispatch","logIn","payload","setAuthenticationPopup","checkAuthentication","AuthFormPopup","props","handleChange","name","value","e","stopPropagation","actualValue","target","length","state","maxLength","setState","focus","isValid","onFocus","onBlur","currentState","handleCheckErrors","names","thisState","forEach","property","text","undefined","newValue","handleSubmit","preventDefault","email","password","Object","keys","key","credentials","trim","then","defaultState","isForgetPassword","closePopup","catch","error","message","handleForgetPassword","handlerShowPassword","isPasswordShown","prevProps","isVisible","styles","form","isPopupHidden","emailContainerField","inputs","placeholder","emailValidator","validator","bottomLabel","bottomLabelActive","isLogin","passwordContainerField","passwordValidator","type","buttonContainer","errorMessage","button","signIn","forgetPassordButton","forgetPassword","Component","propTypes","PropTypes","object","isRequired","func","bool"],"mappings":"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","file":"AuthFormPopup.jsx","sourceRoot":"/Users/dimasabitov/Downloads/deltaway.20","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\n\nimport isUndefined from '@tinkoff/utils/is/undefined';\nimport isObject from '@tinkoff/utils/is/object';\nimport isArray from '@tinkoff/utils/is/array';\nimport required from '../Form/validators/required';\nimport email from '../Form/validators/email';\n\nimport pathOr from '@tinkoff/utils/object/pathOr';\nimport FormInput from '../FormInput/FormInput';\nimport classNames from 'classnames';\n\nimport styles from './AuthFormPopup.css';\nimport propOr from '@tinkoff/utils/object/propOr';\nimport ResetPasswordFormPopup from '../ResetPasswordFormPopup/ResetPasswordFormPopup';\n\nimport logIn from '../../../services/client/logIn';\nimport checkAuthentication from '../../../services/client/checkAuthentication';\n\nimport setAuthenticationPopup from '../../../actions/setAuthenticationPopup';\n\nconst mapStateToProps = ({ application }) => {\n    return {\n        langMap: application.langMap\n    };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n    logIn: payload => dispatch(logIn(payload)),\n    setAuthenticationPopup: payload => dispatch(setAuthenticationPopup(payload)),\n    checkAuthentication: payload => dispatch(checkAuthentication(payload))\n});\n\nclass AuthFormPopup extends Component {\n    static propTypes = {\n        langMap: PropTypes.object.isRequired,\n        logIn: PropTypes.func.isRequired,\n        setAuthenticationPopup: PropTypes.func.isRequired,\n        checkAuthentication: PropTypes.func.isRequired,\n        isVisible: PropTypes.bool.isRequired\n    };\n\n    constructor (props) {\n        super(props);\n        this.state = {\n            ...this.defaultState(),\n            isForgetPassword: false,\n            isPasswordShown: false\n        };\n    }\n\n    componentDidUpdate (prevProps) {\n        if (prevProps.isVisible !== this.props.isVisible && !this.props.isVisible) {\n            this.setState({\n                ...this.defaultState(),\n                isForgetPassword: false\n            });\n        }\n    }\n\n    defaultState () {\n        return {\n            email: { value: '', focus: false, isValid: true },\n            password: { value: '', focus: false, isValid: true },\n            error: null\n        };\n    };\n\n    handleChange = (name, value) => e => {\n        e.stopPropagation();\n        const actualValue = isUndefined(value) ? e.target.value : value;\n\n        if (actualValue.length > this.state.maxLength) return;\n\n        this.setState({\n            [name]: { ...this.state[name], value: actualValue, focus: isUndefined(value), isValid: true }\n        });\n    };\n\n    onFocus = name => e => {\n        e.stopPropagation();\n        this.setState({\n            [name]: { ...this.state[name], focus: !this.state[name].focus }\n        });\n    };\n\n    onBlur = name => {\n        const currentState = this.handleCheckErrors([name]);\n\n        this.setState({\n            [name]: { ...this.state[name], focus: false, isValid: currentState[name].isValid }\n        });\n    };\n\n    handleCheckErrors = (names = []) => {\n        const thisState = {};\n\n        names.forEach(name => {\n            const property = this.state[name];\n\n            if (isObject(property) && !isArray(property)) {\n                const value = this.state[name].value;\n                let isValid = (\n                    name === 'email' ? email(value, { text: false })\n                        : required(value, { text: false })) === undefined;\n\n                const newValue = { ...property, isValid };\n                thisState[name] = newValue;\n\n                this.setState({\n                    [name]: newValue\n                });\n            }\n        });\n\n        return thisState;\n    };\n\n    handleSubmit = e => {\n        e.preventDefault();\n\n        const { email, password } = this.state;\n\n        const thisState = this.handleCheckErrors(Object.keys(this.state));\n        let isValid = true;\n\n        for (let key in thisState) {\n            if (!pathOr(['isValid'], true, thisState[key])) {\n                isValid = false;\n            }\n        }\n\n        if (isValid) {\n            const credentials = {\n                email: email.value.trim(),\n                password: password.value.trim()\n            };\n\n            this.props.logIn(credentials)\n                .then(() => {\n                    this.setState({\n                        ...this.defaultState(),\n                        isForgetPassword: false\n\n                    });\n                    this.props.checkAuthentication();\n                    this.closePopup();\n                })\n                .catch((e) => this.setState({ error: e.message }));\n        }\n    };\n\n    closePopup = () => {\n        this.props.setAuthenticationPopup(false);\n    };\n\n    handleForgetPassword = () => {\n        this.setState({\n            isForgetPassword: !this.state.isForgetPassword\n        });\n    }\n\n    handlerShowPassword = () => {\n        this.setState({ isPasswordShown: !this.state.isPasswordShown });\n    }\n\n    render () {\n        const { langMap } = this.props;\n        const { isForgetPassword, isPasswordShown, error } = this.state;\n        const text = propOr('auth', {}, langMap);\n\n        return (\n            [\n                <form key={0} className={classNames(styles.form, {\n                    [styles.isPopupHidden]: isForgetPassword\n                })} onSubmit={this.handleSubmit}>\n                    <div className={styles.emailContainerField}>\n                        <FormInput\n                            isError={!this.state['email'].isValid}\n                            texts={{ email: `${text.inputs.email.placeholder}`, emailValidator: `${text.inputs.email.validator}` }}\n                            name='email'\n                            type=\"email\"\n                            onFocus={this.onFocus}\n                            onBlur={this.onBlur}\n                            handleChange={this.handleChange}\n                            value={this.state.email.value}\n                            focus={this.state.email.value}\n                        />\n                        <div className={classNames(styles.bottomLabel, {\n                            [styles.bottomLabelActive]: this.state['email'].isValid\n                        })}>{text.isLogin}</div>\n                    </div>\n                    <div className={styles.passwordContainerField}>\n                        <FormInput\n                            isError={!this.state['password'].isValid}\n                            texts={{ password: `${text.inputs.password.placeholder}`, passwordValidator: `${text.inputs.password.validator}` }}\n                            name='password'\n                            onFocus={this.onFocus}\n                            onBlur={this.onBlur}\n                            handleChange={this.handleChange}\n                            value={this.state.password.value}\n                            focus={this.state.password.focus}\n                            {...!isPasswordShown && { type: 'password' }}\n                        />\n                        <img\n                            onClick={this.handlerShowPassword}\n                            src=\"/src/apps/client/ui/components/AuthFormPopup/images/password.svg\"\n                            alt=\"\"\n                        />\n                    </div>\n                    <div className={styles.buttonContainer}>\n                        {error && <div className={styles.errorMessage}>{error}</div>}\n                        <button className={classNames(styles.button)} type='submit'>{text.signIn}</button>\n                    </div>\n                    <div className={styles.forgetPassordButton} onClick={this.handleForgetPassword}>{text.forgetPassword}</div>\n                </form>,\n                <ResetPasswordFormPopup key={1} isOpen={isForgetPassword} handleBackClick={this.handleForgetPassword} handleClose={this.closePopup} />\n            ]\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AuthFormPopup);\n"]}]}