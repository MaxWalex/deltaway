{"remainingRequest":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js??ref--13-2!C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\src\\apps\\admin\\services\\messageWebsocket.js","dependencies":[{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\src\\apps\\admin\\services\\messageWebsocket.js","mtime":1671546452000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\.babelrc","mtime":1671546158000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1671546958000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js","mtime":1671546956000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _socket = require('socket.io-client');\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _constants = require('../constants/constants');\n\nvar _eventemitter = require('eventemitter3');\n\nvar _eventemitter2 = _interopRequireDefault(_eventemitter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar WEBSOCKET_URL = process.env.NODE_ENV === 'production' ? 'wss://deltaway.io:5050' : 'ws://localhost:5050';\n\nvar MessageWebsocketController = function () {\n    function MessageWebsocketController() {\n        (0, _classCallCheck3.default)(this, MessageWebsocketController);\n        this.events = new _eventemitter2.default();\n    }\n\n    (0, _createClass3.default)(MessageWebsocketController, [{\n        key: 'connect',\n        value: function connect() {\n            var _this = this;\n\n            var socket = (0, _socket2.default)(WEBSOCKET_URL, { transports: ['websocket'] });\n\n            this.socket = socket;\n\n            socket.on('connect', function () {\n                var token = localStorage.getItem(_constants.TOKEN_LOCAL_STORAGE_NAME);\n\n                socket.emit('token', {\n                    type: 'admin',\n                    token: token\n                });\n            });\n\n            socket.on('message', function (data) {\n                _this.events.emit('message', data);\n            });\n        }\n    }, {\n        key: 'disconnect',\n        value: function disconnect() {\n            this.socket && this.socket.disconnect();\n            this.socket = null;\n        }\n    }, {\n        key: 'sendMessage',\n        value: function sendMessage(_ref) {\n            var receiverId = _ref.receiverId,\n                text = _ref.text;\n\n            if (!this.socket) {\n                return;\n            }\n\n            this.socket.emit('message', {\n                receiverId: receiverId,\n                text: text\n            });\n        }\n    }]);\n    return MessageWebsocketController;\n}();\n\nvar messageWebsocketController = new MessageWebsocketController();\n\nexports.default = messageWebsocketController;\nmessageWebsocketController.i = 'messageWebsocketController';\nmessageWebsocketController.i = 'messageWebsocketController';",{"version":3,"sources":["src\\apps\\admin\\services\\messageWebsocket.js"],"names":["WEBSOCKET_URL","process","env","NODE_ENV","MessageWebsocketController","events","EventEmitter","socket","transports","on","token","localStorage","getItem","TOKEN_LOCAL_STORAGE_NAME","emit","type","data","disconnect","receiverId","text","messageWebsocketController"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AAEA;;AACA;;;;;;AAEA,IAAMA,gBAAgBC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,wBAAxC,GAAmE,qBAAzF;;IAEMC,0B;;;aACFC,M,GAAS,IAAIC,sBAAJ,E;;;;;kCAEE;AAAA;;AACP,gBAAMC,SAAS,sBAAGP,aAAH,EAAkB,EAAEQ,YAAY,CAAC,WAAD,CAAd,EAAlB,CAAf;;AAEA,iBAAKD,MAAL,GAAcA,MAAd;;AAEAA,mBAAOE,EAAP,CAAU,SAAV,EAAqB,YAAM;AACvB,oBAAMC,QAAQC,aAAaC,OAAb,CAAqBC,mCAArB,CAAd;;AAEAN,uBAAOO,IAAP,CAAY,OAAZ,EAAqB;AACjBC,0BAAM,OADW;AAEjBL;AAFiB,iBAArB;AAIH,aAPD;;AASAH,mBAAOE,EAAP,CAAU,SAAV,EAAqB,gBAAQ;AACzB,sBAAKJ,MAAL,CAAYS,IAAZ,CAAiB,SAAjB,EAA4BE,IAA5B;AACH,aAFD;AAGH;;;qCAEa;AACV,iBAAKT,MAAL,IAAe,KAAKA,MAAL,CAAYU,UAAZ,EAAf;AACA,iBAAKV,MAAL,GAAc,IAAd;AACH;;;0CAEkC;AAAA,gBAApBW,UAAoB,QAApBA,UAAoB;AAAA,gBAARC,IAAQ,QAARA,IAAQ;;AAC/B,gBAAI,CAAC,KAAKZ,MAAV,EAAkB;AACd;AACH;;AAED,iBAAKA,MAAL,CAAYO,IAAZ,CAAiB,SAAjB,EAA4B;AACxBI,sCADwB;AAExBC;AAFwB,aAA5B;AAIH;;;;;AAGL,IAAMC,6BAA6B,IAAIhB,0BAAJ,EAAnC;;kBAEegB,0B","file":"messageWebsocket.js","sourceRoot":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20","sourcesContent":["import io from 'socket.io-client';\n\nimport { TOKEN_LOCAL_STORAGE_NAME } from '../constants/constants';\nimport EventEmitter from 'eventemitter3';\n\nconst WEBSOCKET_URL = process.env.NODE_ENV === 'production' ? 'wss://deltaway.io:5050' : 'ws://localhost:5050';\n\nclass MessageWebsocketController {\n    events = new EventEmitter();\n\n    connect () {\n        const socket = io(WEBSOCKET_URL, { transports: ['websocket'] });\n\n        this.socket = socket;\n\n        socket.on('connect', () => {\n            const token = localStorage.getItem(TOKEN_LOCAL_STORAGE_NAME);\n\n            socket.emit('token', {\n                type: 'admin',\n                token\n            });\n        });\n\n        socket.on('message', data => {\n            this.events.emit('message', data);\n        });\n    }\n\n    disconnect () {\n        this.socket && this.socket.disconnect();\n        this.socket = null;\n    }\n\n    sendMessage ({ receiverId, text }) {\n        if (!this.socket) {\n            return;\n        }\n\n        this.socket.emit('message', {\n            receiverId,\n            text\n        });\n    }\n}\n\nconst messageWebsocketController = new MessageWebsocketController();\n\nexport default messageWebsocketController;\n"]}]}