{"remainingRequest":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js??ref--13-2!C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\src\\apps\\admin\\ui\\pages\\TransactionsPage\\TransactionsPage.jsx","dependencies":[{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\src\\apps\\admin\\ui\\pages\\TransactionsPage\\TransactionsPage.jsx","mtime":1671546446000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\.babelrc","mtime":1671546158000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1671546958000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js","mtime":1671546956000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _slicedToArray2 = require('babel-runtime/helpers/slicedToArray');\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _React$createElement10;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _pathOr = require('@tinkoff/utils/object/pathOr');\n\nvar _pathOr2 = _interopRequireDefault(_pathOr);\n\nvar _CircularProgress = require('@material-ui/core/CircularProgress');\n\nvar _CircularProgress2 = _interopRequireDefault(_CircularProgress);\n\nvar _Modal = require('@material-ui/core/Modal');\n\nvar _Modal2 = _interopRequireDefault(_Modal);\n\nvar _Paper = require('@material-ui/core/Paper');\n\nvar _Paper2 = _interopRequireDefault(_Paper);\n\nvar _styles = require('@material-ui/core/styles');\n\nvar _AdminTable = require('../../components/AdminTable/AdminTable.jsx');\n\nvar _AdminTable2 = _interopRequireDefault(_AdminTable);\n\nvar _MoneyOutputForm = require('../../components/MoneyOutputForm/MoneyOutputForm.jsx');\n\nvar _MoneyOutputForm2 = _interopRequireDefault(_MoneyOutputForm);\n\nvar _reactRedux = require('react-redux');\n\nvar _getUsers2 = require('../../../services/getUsers');\n\nvar _getUsers3 = _interopRequireDefault(_getUsers2);\n\nvar _getMoneyOutput2 = require('../../../services/getMoneyOutput');\n\nvar _getMoneyOutput3 = _interopRequireDefault(_getMoneyOutput2);\n\nvar _editMoneyOutput2 = require('../../../services/editMoneyOutput');\n\nvar _editMoneyOutput3 = _interopRequireDefault(_editMoneyOutput2);\n\nvar _deleteOutputsByIds = require('../../../services/deleteOutputsByIds');\n\nvar _deleteOutputsByIds2 = _interopRequireDefault(_deleteOutputsByIds);\n\nvar _outputWebsocket = require('../../../services/outputWebsocket');\n\nvar _outputWebsocket2 = _interopRequireDefault(_outputWebsocket);\n\nvar _getUnvisitedMoneyOutput2 = require('../../../services/getUnvisitedMoneyOutput');\n\nvar _getUnvisitedMoneyOutput3 = _interopRequireDefault(_getUnvisitedMoneyOutput2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar headerRows = [{ id: 'name', label: 'Имя' }, { id: 'amount', label: 'Сумма' }, { id: 'status', label: 'Статус' }];\n\nvar materialStyles = function materialStyles(theme) {\n    return {\n        loader: {\n            height: 'calc(100vh - 64px)',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center'\n        },\n        modal: {\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center'\n        },\n        modalContent: {\n            position: 'absolute',\n            width: '1200px',\n            backgroundColor: theme.palette.background.paper,\n            boxShadow: theme.shadows[5],\n            padding: theme.spacing.unit * 4,\n            outline: 'none',\n            overflowY: 'auto',\n            maxHeight: '100vh',\n            '@media (max-width:1300px)': {\n                width: '90%'\n            }\n        },\n        warningContent: {\n            paddingBottom: '0'\n        },\n        columnName: {\n            maxWidth: '400px',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            '@media (max-width:1020px)': {\n                maxWidth: '200px'\n            },\n            '@media (max-width:750px)': {\n                maxWidth: '100px'\n            },\n            '@media (max-width:340px)': {\n                maxWidth: '80px'\n            }\n        },\n        columnAlias: {\n            maxWidth: '200px',\n            display: 'block',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            '@media (max-width:850px)': {\n                maxWidth: '100px'\n            },\n            '@media (max-width:400px)': {\n                maxWidth: '50px'\n            }\n        }\n    };\n};\n\nvar mapStateToProps = function mapStateToProps(_ref) {\n    var data = _ref.data;\n\n    return {\n        output: data.output\n    };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n    return {\n        getUsers: function getUsers(payload) {\n            return dispatch((0, _getUsers3.default)(payload));\n        },\n        getMoneyOutput: function getMoneyOutput(payload) {\n            return dispatch((0, _getMoneyOutput3.default)(payload));\n        },\n        editMoneyOutput: function editMoneyOutput(payload) {\n            return dispatch((0, _editMoneyOutput3.default)(payload));\n        },\n        deleteMoneyOutput: function deleteMoneyOutput(payload) {\n            return dispatch((0, _deleteOutputsByIds2.default)(payload));\n        },\n        getUnvisitedMoneyOutput: function getUnvisitedMoneyOutput(payload) {\n            return dispatch((0, _getUnvisitedMoneyOutput3.default)(payload));\n        }\n    };\n};\n\nvar _ref5 = _react2.default.createElement(_CircularProgress2.default, (_React$createElement10 = {\n    'data-qa-file': 'TransactionsPage'\n}, (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'TransactionsPage'), _React$createElement10));\n\nvar TransactionsPage = function (_Component) {\n    (0, _inherits3.default)(TransactionsPage, _Component);\n\n    function TransactionsPage() {\n        var _ref2;\n\n        (0, _classCallCheck3.default)(this, TransactionsPage);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (_ref2 = TransactionsPage.__proto__ || Object.getPrototypeOf(TransactionsPage)).call.apply(_ref2, [this].concat(args)));\n\n        _this.getData = function () {\n            return Promise.all([_this.props.getMoneyOutput(), _this.props.getUsers(false)]).then(function (_ref3) {\n                var _ref4 = (0, _slicedToArray3.default)(_ref3, 2),\n                    outputs = _ref4[0],\n                    users = _ref4[1];\n\n                _this.setState({\n                    loading: false,\n                    outputByUsers: outputs.payload.reduce(function (acc, item) {\n                        var user = users.payload.find(function (user) {\n                            return user.id === item.userId;\n                        });\n\n                        if (user) {\n                            acc.push({\n                                name: user.name,\n                                surname: user.surname,\n                                status: item.status,\n                                date: item.createdAt,\n                                createdAtDate: item.createdAtDate,\n                                amount: item.amount,\n                                id: item.id,\n                                visited: item.visited\n                            });\n                        }\n\n                        return acc;\n                    }, [])\n                });\n            });\n        };\n\n        _this.qwerty = function (output) {\n            _this.props.getUsers(false).then(function (users) {\n                var user = users.payload.find(function (user) {\n                    return user.id === output.userId;\n                });\n\n                _this.setState({\n                    outputByUsers: [].concat((0, _toConsumableArray3.default)(_this.state.outputByUsers), [{\n                        date: output.createdAt,\n                        createdAtDate: output.createdAtDate,\n                        name: user.name,\n                        surname: user.surname,\n                        status: output.status,\n                        amount: output.amount,\n                        id: output.id,\n                        visited: output.visited\n                    }])\n                });\n            });\n        };\n\n        _this.handleFormDone = function () {\n            _this.getData().then(_this.handleCloseUserForm);\n        };\n\n        _this.handleFormOpen = function (user) {\n            return function () {\n                _this.setState({\n                    formShowed: true,\n                    editableUser: user\n                });\n                _this.props.editMoneyOutput((0, _extends3.default)({}, user, { visited: true })).then(_this.getData());\n                _this.props.getUnvisitedMoneyOutput();\n            };\n        };\n\n        _this.handleCloseUserForm = function () {\n            _this.setState({\n                formShowed: false,\n                editableUser: null\n            });\n        };\n\n        _this.handleOutputDelete = function (ids) {\n            return _this.props.deleteMoneyOutput(ids).then(function () {\n                _this.getData();\n                _this.props.getUnvisitedMoneyOutput();\n            });\n        };\n\n        _this.state = {\n            loading: true,\n            formShowed: false,\n            editableUser: null\n        };\n        _this.tableCells = [{ prop: function prop(user) {\n                var _React$createElement;\n\n                return _react2.default.createElement(\n                    'div',\n                    (_React$createElement = { className: _this.props.classes.columnName, 'data-qa-file': 'TransactionsPage'\n                    }, (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'TransactionsPage'), _React$createElement),\n                    (0, _pathOr2.default)(['name'], '', user),\n                    ' ',\n                    (0, _pathOr2.default)(['surname'], '', user)\n                );\n            } }, { prop: function prop(user) {\n                var _React$createElement2;\n\n                return _react2.default.createElement(\n                    'div',\n                    (_React$createElement2 = { className: _this.props.classes.columnName, 'data-qa-file': 'TransactionsPage'\n                    }, (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'TransactionsPage'), _React$createElement2),\n                    (0, _pathOr2.default)(['amount'], '', user)\n                );\n            } }, { prop: function prop(user) {\n                var _React$createElement3;\n\n                return _react2.default.createElement(\n                    'div',\n                    (_React$createElement3 = { className: _this.props.classes.columnName, 'data-qa-file': 'TransactionsPage'\n                    }, (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'TransactionsPage'), _React$createElement3),\n                    (0, _pathOr2.default)(['status'], '', user)\n                );\n            } }];\n        return _this;\n    }\n\n    (0, _createClass3.default)(TransactionsPage, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            _outputWebsocket2.default.events.on('output', this.qwerty);\n\n            this.getData();\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            _outputWebsocket2.default.events.removeListener('output', this.qwerty);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _React$createElement5, _React$createElement6, _React$createElement7, _React$createElement8, _React$createElement9;\n\n            var classes = this.props.classes;\n            var _state = this.state,\n                loading = _state.loading,\n                editableUser = _state.editableUser,\n                formShowed = _state.formShowed,\n                outputByUsers = _state.outputByUsers;\n\n\n            if (loading) {\n                var _React$createElement4;\n\n                return _react2.default.createElement(\n                    'div',\n                    (_React$createElement4 = { className: classes.loader, 'data-qa-file': 'TransactionsPage'\n                    }, (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'TransactionsPage'), _React$createElement4),\n                    _ref5\n                );\n            }\n\n            return _react2.default.createElement(\n                'div',\n                (_React$createElement9 = {\n                    'data-qa-file': 'TransactionsPage'\n                }, (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'TransactionsPage'), _React$createElement9),\n                _react2.default.createElement(_AdminTable2.default, (_React$createElement5 = {\n                    headerRows: headerRows,\n                    tableCells: this.tableCells,\n                    values: outputByUsers.sort(function (prev, next) {\n                        return next.createdAtDate - prev.createdAtDate;\n                    }),\n                    headerText: '\\u0417\\u0430\\u043F\\u0440\\u043E\\u0441\\u044B \\u043D\\u0430 \\u0432\\u044B\\u0432\\u043E\\u0434',\n                    deleteValueWarningTitle: '\\u0412\\u044B \\u0442\\u043E\\u0447\\u043D\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441?',\n                    deleteValuesWarningTitle: '\\u0412\\u044B \\u0442\\u043E\\u0447\\u043D\\u043E \\u0445\\u043E\\u0442\\u0438\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u044B?',\n                    onDelete: this.handleOutputDelete,\n                    onFormOpen: this.handleFormOpen,\n                    isAddButton: false,\n                    'data-qa-file': 'TransactionsPage'\n                }, (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'TransactionsPage'), _React$createElement5)),\n                _react2.default.createElement(\n                    _Modal2.default,\n                    (_React$createElement8 = { open: formShowed, onClose: this.handleCloseUserForm, className: classes.modal, disableEnforceFocus: true, 'data-qa-file': 'TransactionsPage'\n                    }, (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'TransactionsPage'), _React$createElement8),\n                    _react2.default.createElement(\n                        _Paper2.default,\n                        (_React$createElement7 = { className: classes.modalContent, 'data-qa-file': 'TransactionsPage'\n                        }, (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'TransactionsPage'), _React$createElement7),\n                        _react2.default.createElement(_MoneyOutputForm2.default, (_React$createElement6 = { user: editableUser, onDone: this.handleFormDone, 'data-qa-file': 'TransactionsPage'\n                        }, (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'TransactionsPage'), (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'TransactionsPage'), _React$createElement6))\n                    )\n                )\n            );\n        }\n    }]);\n    return TransactionsPage;\n}(_react.Component);\n\nexports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)((0, _styles.withStyles)(materialStyles)(TransactionsPage));",null]}