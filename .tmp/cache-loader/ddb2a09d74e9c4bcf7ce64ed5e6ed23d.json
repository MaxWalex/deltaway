{"remainingRequest":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js??ref--13-2!C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\src\\apps\\admin\\ui\\pages\\ChatPage\\ChatPage.jsx","dependencies":[{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\src\\apps\\admin\\ui\\pages\\ChatPage\\ChatPage.jsx","mtime":1671546444000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\.babelrc","mtime":1671546158000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1671546958000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js","mtime":1671546956000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends3 = require('babel-runtime/helpers/extends');\n\nvar _extends4 = _interopRequireDefault(_extends3);\n\nvar _slicedToArray2 = require('babel-runtime/helpers/slicedToArray');\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _React$createElement31;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _last = require('@tinkoff/utils/array/last');\n\nvar _last2 = _interopRequireDefault(_last);\n\nvar _findIndex = require('@tinkoff/utils/array/findIndex');\n\nvar _findIndex2 = _interopRequireDefault(_findIndex);\n\nvar _TextField = require('@material-ui/core/TextField/TextField');\n\nvar _TextField2 = _interopRequireDefault(_TextField);\n\nvar _reactRedux = require('react-redux');\n\nvar _ChatPage = require('./ChatPage.css');\n\nvar _ChatPage2 = _interopRequireDefault(_ChatPage);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _format = require('date-fns/format');\n\nvar _format2 = _interopRequireDefault(_format);\n\nvar _isToday = require('date-fns/isToday');\n\nvar _isToday2 = _interopRequireDefault(_isToday);\n\nvar _isThisWeek = require('date-fns/isThisWeek');\n\nvar _isThisWeek2 = _interopRequireDefault(_isThisWeek);\n\nvar _messageWebsocket = require('../../../services/messageWebsocket');\n\nvar _messageWebsocket2 = _interopRequireDefault(_messageWebsocket);\n\nvar _getMessageHistory2 = require('../../../services/getMessageHistory');\n\nvar _getMessageHistory3 = _interopRequireDefault(_getMessageHistory2);\n\nvar _getUsers2 = require('../../../services/getUsers');\n\nvar _getUsers3 = _interopRequireDefault(_getUsers2);\n\nvar _editMessage2 = require('../../../services/editMessage');\n\nvar _editMessage3 = _interopRequireDefault(_editMessage2);\n\nvar _getUnvisitedMessageHistory2 = require('../../../services/getUnvisitedMessageHistory');\n\nvar _getUnvisitedMessageHistory3 = _interopRequireDefault(_getUnvisitedMessageHistory2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n    return {\n        getMessageHistory: function getMessageHistory(payload) {\n            return dispatch((0, _getMessageHistory3.default)(payload));\n        },\n        getUsers: function getUsers(payload) {\n            return dispatch((0, _getUsers3.default)(payload));\n        },\n        editMessage: function editMessage(payload) {\n            return dispatch((0, _editMessage3.default)(payload));\n        },\n        getUnvisitedMessageHistory: function getUnvisitedMessageHistory(payload) {\n            return dispatch((0, _getUnvisitedMessageHistory3.default)(payload));\n        }\n    };\n};\n\nvar _ref3 = _react2.default.createElement('path', (_React$createElement31 = { fillRule: 'evenodd', clipRule: 'evenodd', d: 'M6.97016 0.969982C7.11011 0.831254 7.29903 0.753178 7.49609 0.752634C7.69315 0.752091 7.8825 0.829123 8.02321 0.967077C8.16392 1.10503 8.24469 1.29282 8.24805 1.48985C8.25141 1.68688 8.17709 1.87731 8.04116 2.01998L4.04916 7.00998C3.98055 7.08388 3.89774 7.14318 3.80569 7.18435C3.71364 7.22551 3.61423 7.24769 3.51341 7.24956C3.41259 7.25143 3.31243 7.23294 3.21891 7.19521C3.1254 7.15749 3.04046 7.10129 2.96916 7.02998L0.324157 4.38398C0.250471 4.31532 0.191368 4.23252 0.150376 4.14052C0.109384 4.04852 0.0873427 3.94921 0.0855659 3.8485C0.0837892 3.7478 0.102314 3.64777 0.140035 3.55438C0.177756 3.461 0.2339 3.37616 0.305119 3.30494C0.376338 3.23373 0.461172 3.17758 0.55456 3.13986C0.647948 3.10214 0.747977 3.08361 0.84868 3.08539C0.949383 3.08717 1.0487 3.10921 1.1407 3.1502C1.2327 3.19119 1.3155 3.2503 1.38416 3.32398L3.47816 5.41698L6.95016 0.991982C6.95639 0.984262 6.96306 0.976915 6.97016 0.969982ZM6.05016 6.10998L6.97016 7.02998C7.04144 7.10113 7.12632 7.1572 7.21974 7.19484C7.31316 7.23247 7.4132 7.25091 7.5139 7.24904C7.6146 7.24717 7.71389 7.22504 7.80585 7.18397C7.89781 7.1429 7.98056 7.08373 8.04916 7.00998L12.0412 2.01998C12.1129 1.94918 12.1696 1.86466 12.2079 1.77146C12.2462 1.67826 12.2654 1.57829 12.2642 1.47752C12.263 1.37676 12.2415 1.27726 12.2011 1.18498C12.1606 1.0927 12.1019 1.00952 12.0286 0.940411C11.9552 0.871304 11.8687 0.817686 11.7742 0.782758C11.6797 0.74783 11.5791 0.73231 11.4784 0.737123C11.3778 0.741937 11.2791 0.766986 11.1883 0.810774C11.0976 0.854562 11.0166 0.916192 10.9502 0.991982L7.47716 5.41698L6.99216 4.93098L6.04916 6.10998H6.05016Z', fill: '#00C7C7', 'data-qa-file': 'ChatPage'\n}, (0, _defineProperty3.default)(_React$createElement31, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement31, 'data-qa-file', 'ChatPage'), _React$createElement31));\n\nvar MainPage = function (_Component) {\n    (0, _inherits3.default)(MainPage, _Component);\n\n    function MainPage(props) {\n        (0, _classCallCheck3.default)(this, MainPage);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (MainPage.__proto__ || Object.getPrototypeOf(MainPage)).call(this, props));\n\n        _this.filterChatsBySearch = function (chats) {\n            var search = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _this.state.search;\n\n            return chats.filter(function (messagesByUser) {\n                var user = _this.state.usersMap[messagesByUser.userId];\n                var name = user && (user.name + ' ' + user.surname).toLowerCase();\n\n                return !search || name && name.indexOf(search.toLowerCase()) !== -1;\n            });\n        };\n\n        _this.handleSearchChange = function (event) {\n            var newValue = event.target.value;\n\n            _this.setState({\n                search: newValue,\n                showedMessagesByUsers: _this.filterChatsBySearch(_this.state.messagesByUsers, newValue)\n            });\n        };\n\n        _this.scrollToBottomNewMessage = function () {\n            _this.messagesWrapper.current.classList.remove(_ChatPage2.default.noScrollWrapper);\n            if (_this.messagesWrapper.current.scrollHeight <= _this.messagesWrapper.current.clientHeight) {\n                _this.messagesWrapper.current.classList.add(_ChatPage2.default.noScrollWrapper);\n            } else {\n                _this.messagesWrapper.current.scrollTop = _this.messagesWrapper.current.scrollHeight;\n            }\n        };\n\n        _this.getData = function () {\n            Promise.all([_this.props.getMessageHistory(), _this.props.getUsers()]).then(function (_ref) {\n                var _ref2 = (0, _slicedToArray3.default)(_ref, 2),\n                    messages = _ref2[0],\n                    users = _ref2[1];\n\n                var allUsers = users.payload;\n\n                _this.setState({\n                    users: allUsers,\n                    usersMap: allUsers.reduce(function (result, user) {\n                        return (0, _extends4.default)({}, result, (0, _defineProperty3.default)({}, user.id, user));\n                    }, {})\n                });\n\n                var newMessagesByUsers = allUsers.reduce(function (result, user) {\n                    var currentUserMessages = messages.filter(function (item) {\n                        return user.id === item.senderId || user.id === item.receiverId;\n                    });\n                    var sortedByDateMessages = currentUserMessages.reduce(function (acc, item) {\n                        if (acc[acc.length - 1][0]) {\n                            var currentItemDate = (0, _format2.default)(item.createdAt, 'P');\n                            var currentArrayDate = (0, _format2.default)(acc[acc.length - 1][0].createdAt, 'P');\n\n                            if (currentArrayDate === currentItemDate) {\n                                acc[acc.length - 1].push(item);\n                            } else acc.push([item]);\n                        } else acc[acc.length - 1].push(item);\n\n                        return acc;\n                    }, [[]]);\n                    var unvisitedMessages = currentUserMessages.filter(function (item) {\n                        return item.receiverId === 'admin' && !item.visited;\n                    });\n\n                    return [].concat((0, _toConsumableArray3.default)(result), [{\n                        userId: user.id,\n                        messages: sortedByDateMessages,\n                        unvisitedMessagesCounter: unvisitedMessages.length\n                    }]);\n                }, []).sort(function (prev, next) {\n                    if (!prev.messages[0].length) {\n                        return 1;\n                    }\n                    if (!next.messages[0].length) {\n                        return 1;\n                    }\n                    return (0, _last2.default)(prev.messages[0]).createdAt - (0, _last2.default)(next.messages[0]).createdAt < 0 ? 1 : -1;\n                });\n\n                _this.setState({\n                    activeTabId: newMessagesByUsers[0].userId,\n                    messagesByUsers: newMessagesByUsers,\n                    showedMessagesByUsers: newMessagesByUsers\n                });\n                _this.scrollToBottom();\n            });\n        };\n\n        _this.handleMessage = function (message) {\n            var messagesByUsers = _this.state.messagesByUsers;\n\n            var userId = message.senderId === 'admin' ? message.receiverId : message.senderId;\n\n            var index = (0, _findIndex2.default)(function (messagesByUser) {\n                return messagesByUser.userId === userId;\n            }, messagesByUsers);\n\n            if (index === -1) {\n                messagesByUsers.unshift({ userId: userId, messages: [message] });\n            } else {\n                messagesByUsers[index].messages[messagesByUsers[index].messages.length - 1].push(message);\n                if ((0, _last2.default)((0, _last2.default)(messagesByUsers[index].messages)).receiverId === 'admin') {\n                    messagesByUsers[index].unvisitedMessagesCounter = messagesByUsers[index].unvisitedMessagesCounter + 1;\n                }\n                var messagesByUser = messagesByUsers[index];\n\n                messagesByUsers.splice(index, 1);\n                messagesByUsers.unshift(messagesByUser);\n            }\n\n            _this.setState({\n                messagesByUsers: messagesByUsers,\n                showedMessagesByUsers: _this.filterChatsBySearch(messagesByUsers)\n            }, function () {\n                return _this.scrollToBottomNewMessage();\n            });\n        };\n\n        _this.handleSubmit = function (receiverId) {\n            return function (event) {\n                event.preventDefault();\n                var value = _this.state.value;\n\n\n                _messageWebsocket2.default.sendMessage({\n                    text: value,\n                    receiverId: receiverId\n                });\n\n                _this.setState({\n                    value: '',\n                    activeTabId: receiverId\n                });\n                _this.scrollToBottom();\n            };\n        };\n\n        _this.handleTabClick = function (index, userId) {\n            return function () {\n                var _this$state = _this.state,\n                    messagesByUsers = _this$state.messagesByUsers,\n                    showedMessagesByUsers = _this$state.showedMessagesByUsers;\n\n                var messagesByUsersIndex = (0, _findIndex2.default)(function (messagesByUser) {\n                    return messagesByUser.userId === userId;\n                }, messagesByUsers);\n                messagesByUsers[messagesByUsersIndex] = (0, _extends4.default)({}, messagesByUsers[messagesByUsersIndex], { unvisitedMessagesCounter: 0 });\n                var showedMessagesByUsersIndex = (0, _findIndex2.default)(function (messagesByUser) {\n                    return messagesByUser.userId === userId;\n                }, showedMessagesByUsers);\n                showedMessagesByUsers[showedMessagesByUsersIndex] = (0, _extends4.default)({}, showedMessagesByUsers[showedMessagesByUsersIndex], { unvisitedMessagesCounter: 0 });\n\n                _this.setState({ activeTabId: userId, messagesByUsers: messagesByUsers, showedMessagesByUsers: showedMessagesByUsers });\n                _this.props.editMessage({ id: userId }).then(_this.props.getUnvisitedMessageHistory);\n            };\n        };\n\n        _this.getDateHelper = function (milliseconds) {\n            return (0, _format2.default)(milliseconds, 'd') + ' ' + (0, _format2.default)(milliseconds, 'MMMM');\n        };\n\n        _this.handleChange = function (event) {\n            _this.setState({\n                value: event.target.value\n            });\n        };\n\n        _this.state = {\n            value: '',\n            search: '',\n            messagesByUsers: [],\n            showedMessagesByUsers: [],\n            users: [],\n            activeTabId: null\n        };\n\n        _this.messagesWrapper = _react2.default.createRef();\n        return _this;\n    }\n\n    (0, _createClass3.default)(MainPage, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            _messageWebsocket2.default.events.on('message', this.handleMessage);\n\n            this.getData();\n        }\n    }, {\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps, prevState) {\n            if (prevState.activeTabId !== this.state.activeTabId) {\n                this.scrollToBottom();\n            }\n        }\n    }, {\n        key: 'scrollToBottom',\n        value: function scrollToBottom() {\n            this.messagesWrapper.current.scrollTop = this.messagesWrapper.current.scrollHeight;\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            _messageWebsocket2.default.events.removeListener('message', this.handleMessage);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _React$createElement,\n                _React$createElement2,\n                _this2 = this,\n                _React$createElement11,\n                _React$createElement22,\n                _React$createElement23,\n                _React$createElement24,\n                _React$createElement25,\n                _React$createElement26,\n                _React$createElement27,\n                _React$createElement28,\n                _React$createElement29,\n                _React$createElement30;\n\n            var _state = this.state,\n                value = _state.value,\n                messagesByUsers = _state.messagesByUsers,\n                showedMessagesByUsers = _state.showedMessagesByUsers,\n                activeTabId = _state.activeTabId,\n                usersMap = _state.usersMap,\n                search = _state.search;\n\n\n            return _react2.default.createElement(\n                'div',\n                (_React$createElement30 = { className: _ChatPage2.default.content, style: { position: 'relative' }, 'data-qa-file': 'ChatPage'\n                }, (0, _defineProperty3.default)(_React$createElement30, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement30, 'data-qa-file', 'ChatPage'), _React$createElement30),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement2 = {\n                        'data-qa-file': 'ChatPage'\n                    }, (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'ChatPage'), _React$createElement2),\n                    _react2.default.createElement(_TextField2.default, (_React$createElement = {\n                        label: '\\u041F\\u043E\\u0438\\u0441\\u043A \\u043F\\u043E \\u0438\\u043C\\u0435\\u043D\\u0438 \\u043A\\u043B\\u0438\\u0435\\u043D\\u0442\\u0430',\n                        fullWidth: true,\n                        value: search,\n                        onChange: this.handleSearchChange,\n                        margin: 'normal',\n                        variant: 'outlined',\n                        type: 'text',\n                        'data-qa-file': 'ChatPage'\n                    }, (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'ChatPage'), _React$createElement))\n                ),\n                _react2.default.createElement(\n                    'form',\n                    (_React$createElement29 = { className: _ChatPage2.default.messengerContainer, onSubmit: messagesByUsers.length ? this.handleSubmit(activeTabId) : undefined, 'data-qa-file': 'ChatPage'\n                    }, (0, _defineProperty3.default)(_React$createElement29, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement29, 'data-qa-file', 'ChatPage'), _React$createElement29),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement11 = { className: _ChatPage2.default.contacts, 'data-qa-file': 'ChatPage'\n                        }, (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'ChatPage'), _React$createElement11),\n                        showedMessagesByUsers.map(function (messagesByUser, i) {\n                            var _React$createElement3, _React$createElement4, _React$createElement5, _React$createElement6, _React$createElement7, _React$createElement8, _React$createElement9, _React$createElement10;\n\n                            var user = usersMap[messagesByUser.userId];\n                            var lastMessage = messagesByUser.messages ? (0, _last2.default)(messagesByUser.messages[messagesByUser.messages.length - 1]) : undefined;\n\n                            return _react2.default.createElement(\n                                'div',\n                                (_React$createElement10 = { className: (0, _classnames2.default)(_ChatPage2.default.contact, (0, _defineProperty3.default)({}, _ChatPage2.default.active, activeTabId === messagesByUser.userId)),\n                                    key: i, onClick: _this2.handleTabClick(i, user.id), 'data-qa-file': 'ChatPage'\n                                }, (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'ChatPage'), _React$createElement10),\n                                _react2.default.createElement(\n                                    'div',\n                                    (_React$createElement8 = { className: _ChatPage2.default.info, 'data-qa-file': 'ChatPage'\n                                    }, (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'ChatPage'), _React$createElement8),\n                                    _react2.default.createElement(\n                                        'h1',\n                                        (_React$createElement3 = { className: _ChatPage2.default.userFullName, 'data-qa-file': 'ChatPage'\n                                        }, (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'ChatPage'), _React$createElement3),\n                                        user.name,\n                                        ' ',\n                                        user.surname\n                                    ),\n                                    _react2.default.createElement(\n                                        'div',\n                                        (_React$createElement7 = { className: _ChatPage2.default.lastMessage, 'data-qa-file': 'ChatPage'\n                                        }, (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'ChatPage'), _React$createElement7),\n                                        lastMessage && lastMessage.senderId === 'admin' && _react2.default.createElement(\n                                            'div',\n                                            (_React$createElement4 = { className: _ChatPage2.default.messageYou, 'data-qa-file': 'ChatPage'\n                                            }, (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'ChatPage'), _React$createElement4),\n                                            '\\u0412\\u044B:'\n                                        ),\n                                        lastMessage && _react2.default.createElement(\n                                            'div',\n                                            (_React$createElement5 = { className: _ChatPage2.default.text, 'data-qa-file': 'ChatPage'\n                                            }, (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'ChatPage'), _React$createElement5),\n                                            lastMessage.text\n                                        ),\n                                        lastMessage && _react2.default.createElement(\n                                            'div',\n                                            (_React$createElement6 = { className: _ChatPage2.default.date, 'data-qa-file': 'ChatPage'\n                                            }, (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'ChatPage'), _React$createElement6),\n                                            (0, _isToday2.default)(lastMessage.createdAt) ? (0, _format2.default)(lastMessage.createdAt, 'HH:mm') : (0, _isThisWeek2.default)(lastMessage.createdAt) ? (0, _format2.default)(lastMessage.createdAt, 'EEEE') : (0, _format2.default)(lastMessage.createdAt, 'P')\n                                        )\n                                    )\n                                ),\n                                messagesByUser.unvisitedMessagesCounter ? _react2.default.createElement(\n                                    'span',\n                                    (_React$createElement9 = { className: _ChatPage2.default.rate, 'data-qa-file': 'ChatPage'\n                                    }, (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'ChatPage'), _React$createElement9),\n                                    messagesByUser.unvisitedMessagesCounter\n                                ) : undefined\n                            );\n                        })\n                    ),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement28 = { className: _ChatPage2.default.messages, 'data-qa-file': 'ChatPage'\n                        }, (0, _defineProperty3.default)(_React$createElement28, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement28, 'data-qa-file', 'ChatPage'), _React$createElement28),\n                        _react2.default.createElement(\n                            'div',\n                            (_React$createElement22 = { ref: this.messagesWrapper, className: _ChatPage2.default.messagesWrapper, 'data-qa-file': 'ChatPage'\n                            }, (0, _defineProperty3.default)(_React$createElement22, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement22, 'data-qa-file', 'ChatPage'), _React$createElement22),\n                            (messagesByUsers.find(function (messagesByUser) {\n                                return messagesByUser.userId === activeTabId;\n                            }) || { messages: [] }).messages.map(function (item, i) {\n                                if (item.length) {\n                                    var _React$createElement21;\n\n                                    return _react2.default.createElement(\n                                        'div',\n                                        (_React$createElement21 = { className: _ChatPage2.default.messagesContainer, 'data-attr': _this2.getDateHelper(item[0].createdAt), 'data-qa-file': 'ChatPage'\n                                        }, (0, _defineProperty3.default)(_React$createElement21, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement21, 'data-qa-file', 'ChatPage'), _React$createElement21),\n                                        item.map(function (message, i) {\n                                            var _React$createElement12, _React$createElement13, _React$createElement14, _React$createElement15, _React$createElement16, _React$createElement17, _React$createElement18, _React$createElement19, _React$createElement20;\n\n                                            var isMyMessage = message.senderId === 'admin';\n                                            var user = usersMap[message.senderId];\n\n                                            return _react2.default.createElement(\n                                                'div',\n                                                (_React$createElement20 = { key: i, className: (0, _classnames2.default)(_ChatPage2.default.message, (0, _defineProperty3.default)({}, _ChatPage2.default.messageYou, isMyMessage)), 'data-qa-file': 'ChatPage'\n                                                }, (0, _defineProperty3.default)(_React$createElement20, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement20, 'data-qa-file', 'ChatPage'), _React$createElement20),\n                                                _react2.default.createElement(\n                                                    'div',\n                                                    (_React$createElement19 = { className: _ChatPage2.default.messageContent, 'data-qa-file': 'ChatPage'\n                                                    }, (0, _defineProperty3.default)(_React$createElement19, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement19, 'data-qa-file', 'ChatPage'), _React$createElement19),\n                                                    _react2.default.createElement(\n                                                        'div',\n                                                        (_React$createElement17 = { className: _ChatPage2.default.messageContentTop, 'data-qa-file': 'ChatPage'\n                                                        }, (0, _defineProperty3.default)(_React$createElement17, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement17, 'data-qa-file', 'ChatPage'), _React$createElement17),\n                                                        _react2.default.createElement(\n                                                            'div',\n                                                            (_React$createElement12 = { className: _ChatPage2.default.messageName, 'data-qa-file': 'ChatPage'\n                                                            }, (0, _defineProperty3.default)(_React$createElement12, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement12, 'data-qa-file', 'ChatPage'), _React$createElement12),\n                                                            !isMyMessage ? user.name + ' ' + user.surname : 'Админ'\n                                                        ),\n\n                                                        // please check, there is no type in messagesByUser.messages\n                                                        !isMyMessage && _react2.default.createElement('div', (_React$createElement13 = { className: _ChatPage2.default.messageType, 'data-qa-file': 'ChatPage'\n                                                        }, (0, _defineProperty3.default)(_React$createElement13, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement13, 'data-qa-file', 'ChatPage'), _React$createElement13))\n                                                        //\n                                                        ,\n                                                        _react2.default.createElement(\n                                                            'div',\n                                                            (_React$createElement16 = { className: _ChatPage2.default.messageDate, 'data-qa-file': 'ChatPage'\n                                                            }, (0, _defineProperty3.default)(_React$createElement16, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement16, 'data-qa-file', 'ChatPage'), _React$createElement16),\n                                                            isMyMessage && _react2.default.createElement(\n                                                                'span',\n                                                                (_React$createElement15 = { className: _ChatPage2.default.receivedIcon, 'data-qa-file': 'ChatPage'\n                                                                }, (0, _defineProperty3.default)(_React$createElement15, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement15, 'data-qa-file', 'ChatPage'), _React$createElement15),\n                                                                _react2.default.createElement(\n                                                                    'svg',\n                                                                    (_React$createElement14 = { width: '13', height: '8', viewBox: '0 0 13 8', fill: 'none', xmlns: 'http://www.w3.org/2000/svg', 'data-qa-file': 'ChatPage'\n                                                                    }, (0, _defineProperty3.default)(_React$createElement14, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement14, 'data-qa-file', 'ChatPage'), _React$createElement14),\n                                                                    _ref3\n                                                                )\n                                                            ),\n                                                            (0, _format2.default)(message.createdAt, 'HH:mm')\n                                                        )\n                                                    ),\n                                                    _react2.default.createElement(\n                                                        'div',\n                                                        (_React$createElement18 = { className: _ChatPage2.default.messageText, 'data-qa-file': 'ChatPage'\n                                                        }, (0, _defineProperty3.default)(_React$createElement18, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement18, 'data-qa-file', 'ChatPage'), _React$createElement18),\n                                                        message.text\n                                                    )\n                                                )\n                                            );\n                                        })\n                                    );\n                                }\n                            })\n                        ),\n                        _react2.default.createElement(\n                            'div',\n                            (_React$createElement27 = { className: _ChatPage2.default.messageInput, 'data-qa-file': 'ChatPage'\n                            }, (0, _defineProperty3.default)(_React$createElement27, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement27, 'data-qa-file', 'ChatPage'), _React$createElement27),\n                            _react2.default.createElement(\n                                'div',\n                                (_React$createElement24 = { className: _ChatPage2.default.inputWrapper, 'data-qa-file': 'ChatPage'\n                                }, (0, _defineProperty3.default)(_React$createElement24, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement24, 'data-qa-file', 'ChatPage'), _React$createElement24),\n                                _react2.default.createElement('input', (_React$createElement23 = { className: _ChatPage2.default.input, value: value, onChange: this.handleChange, type: 'text', 'data-qa-file': 'ChatPage'\n                                }, (0, _defineProperty3.default)(_React$createElement23, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement23, 'data-qa-file', 'ChatPage'), _React$createElement23))\n                            ),\n                            value ? _react2.default.createElement(\n                                'button',\n                                (_React$createElement25 = { className: _ChatPage2.default.button, type: 'submit', 'data-qa-file': 'ChatPage'\n                                }, (0, _defineProperty3.default)(_React$createElement25, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement25, 'data-qa-file', 'ChatPage'), _React$createElement25),\n                                '\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C'\n                            ) : _react2.default.createElement(\n                                'button',\n                                (_React$createElement26 = { className: _ChatPage2.default.buttonDisabled, type: 'button', 'data-qa-file': 'ChatPage'\n                                }, (0, _defineProperty3.default)(_React$createElement26, 'data-qa-file', 'ChatPage'), (0, _defineProperty3.default)(_React$createElement26, 'data-qa-file', 'ChatPage'), _React$createElement26),\n                                '\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C'\n                            )\n                        )\n                    )\n                )\n            );\n        }\n    }]);\n    return MainPage;\n}(_react.Component);\n\nexports.default = (0, _reactRedux.connect)(undefined, mapDispatchToProps)(MainPage);",null]}