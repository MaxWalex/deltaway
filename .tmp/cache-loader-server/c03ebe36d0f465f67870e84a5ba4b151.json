{"remainingRequest":"/home/vps/ppf/node_modules/babel-loader/lib/index.js??ref--5-2!/home/vps/ppf/src/apps/client/ui/components/AuthFormPopup/AuthFormPopup.jsx","dependencies":[{"path":"/home/vps/ppf/src/apps/client/ui/components/AuthFormPopup/AuthFormPopup.jsx","mtime":1671127658557},{"path":"/home/vps/ppf/.babelrc","mtime":1671127885972},{"path":"/home/vps/ppf/node_modules/cache-loader/dist/cjs.js","mtime":1671127657171},{"path":"/home/vps/ppf/node_modules/babel-loader/lib/index.js","mtime":1671127654997}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = require('react-redux');\n\nvar _undefined = require('@tinkoff/utils/is/undefined');\n\nvar _undefined2 = _interopRequireDefault(_undefined);\n\nvar _object = require('@tinkoff/utils/is/object');\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _array = require('@tinkoff/utils/is/array');\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _required = require('../Form/validators/required');\n\nvar _required2 = _interopRequireDefault(_required);\n\nvar _email = require('../Form/validators/email');\n\nvar _email2 = _interopRequireDefault(_email);\n\nvar _pathOr = require('@tinkoff/utils/object/pathOr');\n\nvar _pathOr2 = _interopRequireDefault(_pathOr);\n\nvar _FormInput = require('../FormInput/FormInput');\n\nvar _FormInput2 = _interopRequireDefault(_FormInput);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _AuthFormPopup = require('./AuthFormPopup.css');\n\nvar _AuthFormPopup2 = _interopRequireDefault(_AuthFormPopup);\n\nvar _propOr = require('@tinkoff/utils/object/propOr');\n\nvar _propOr2 = _interopRequireDefault(_propOr);\n\nvar _ResetPasswordFormPopup = require('../ResetPasswordFormPopup/ResetPasswordFormPopup');\n\nvar _ResetPasswordFormPopup2 = _interopRequireDefault(_ResetPasswordFormPopup);\n\nvar _logIn2 = require('../../../services/client/logIn');\n\nvar _logIn3 = _interopRequireDefault(_logIn2);\n\nvar _checkAuthentication2 = require('../../../services/client/checkAuthentication');\n\nvar _checkAuthentication3 = _interopRequireDefault(_checkAuthentication2);\n\nvar _setAuthenticationPopup2 = require('../../../actions/setAuthenticationPopup');\n\nvar _setAuthenticationPopup3 = _interopRequireDefault(_setAuthenticationPopup2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mapStateToProps = function mapStateToProps(_ref) {\n    var application = _ref.application;\n\n    return {\n        langMap: application.langMap\n    };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n    return {\n        logIn: function logIn(payload) {\n            return dispatch((0, _logIn3.default)(payload));\n        },\n        setAuthenticationPopup: function setAuthenticationPopup(payload) {\n            return dispatch((0, _setAuthenticationPopup3.default)(payload));\n        },\n        checkAuthentication: function checkAuthentication(payload) {\n            return dispatch((0, _checkAuthentication3.default)(payload));\n        }\n    };\n};\n\nvar AuthFormPopup = function (_Component) {\n    (0, _inherits3.default)(AuthFormPopup, _Component);\n\n    function AuthFormPopup(props) {\n        (0, _classCallCheck3.default)(this, AuthFormPopup);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (AuthFormPopup.__proto__ || Object.getPrototypeOf(AuthFormPopup)).call(this, props));\n\n        _this.handleChange = function (name, value) {\n            return function (e) {\n                e.stopPropagation();\n                var actualValue = (0, _undefined2.default)(value) ? e.target.value : value;\n\n                if (actualValue.length > _this.state.maxLength) return;\n\n                _this.setState((0, _defineProperty3.default)({}, name, (0, _extends3.default)({}, _this.state[name], { value: actualValue, focus: (0, _undefined2.default)(value), isValid: true })));\n            };\n        };\n\n        _this.onFocus = function (name) {\n            return function (e) {\n                e.stopPropagation();\n                _this.setState((0, _defineProperty3.default)({}, name, (0, _extends3.default)({}, _this.state[name], { focus: !_this.state[name].focus })));\n            };\n        };\n\n        _this.onBlur = function (name) {\n            var currentState = _this.handleCheckErrors([name]);\n\n            _this.setState((0, _defineProperty3.default)({}, name, (0, _extends3.default)({}, _this.state[name], { focus: false, isValid: currentState[name].isValid })));\n        };\n\n        _this.handleCheckErrors = function () {\n            var names = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n            var thisState = {};\n\n            names.forEach(function (name) {\n                var property = _this.state[name];\n\n                if ((0, _object2.default)(property) && !(0, _array2.default)(property)) {\n                    var value = _this.state[name].value;\n                    var isValid = (name === 'email' ? (0, _email2.default)(value, { text: false }) : (0, _required2.default)(value, { text: false })) === undefined;\n\n                    var newValue = (0, _extends3.default)({}, property, { isValid: isValid });\n                    thisState[name] = newValue;\n\n                    _this.setState((0, _defineProperty3.default)({}, name, newValue));\n                }\n            });\n\n            return thisState;\n        };\n\n        _this.handleSubmit = function (e) {\n            e.preventDefault();\n\n            var _this$state = _this.state,\n                email = _this$state.email,\n                password = _this$state.password;\n\n\n            var thisState = _this.handleCheckErrors(Object.keys(_this.state));\n            var isValid = true;\n\n            for (var key in thisState) {\n                if (!(0, _pathOr2.default)(['isValid'], true, thisState[key])) {\n                    isValid = false;\n                }\n            }\n\n            if (isValid) {\n                var credentials = {\n                    email: email.value.trim(),\n                    password: password.value.trim()\n                };\n\n                _this.props.logIn(credentials).then(function () {\n                    _this.setState((0, _extends3.default)({}, _this.defaultState(), {\n                        isForgetPassword: false\n\n                    }));\n                    _this.props.checkAuthentication();\n                    _this.closePopup();\n                }).catch(function (e) {\n                    return _this.setState({ error: e.message });\n                });\n            }\n        };\n\n        _this.closePopup = function () {\n            _this.props.setAuthenticationPopup(false);\n        };\n\n        _this.handleForgetPassword = function () {\n            _this.setState({\n                isForgetPassword: !_this.state.isForgetPassword\n            });\n        };\n\n        _this.handlerShowPassword = function () {\n            _this.setState({ isPasswordShown: !_this.state.isPasswordShown });\n        };\n\n        _this.state = (0, _extends3.default)({}, _this.defaultState(), {\n            isForgetPassword: false,\n            isPasswordShown: false\n        });\n        return _this;\n    }\n\n    (0, _createClass3.default)(AuthFormPopup, [{\n        key: 'componentDidUpdate',\n        value: function componentDidUpdate(prevProps) {\n            if (prevProps.isVisible !== this.props.isVisible && !this.props.isVisible) {\n                this.setState((0, _extends3.default)({}, this.defaultState(), {\n                    isForgetPassword: false\n                }));\n            }\n        }\n    }, {\n        key: 'defaultState',\n        value: function defaultState() {\n            return {\n                email: { value: '', focus: false, isValid: true },\n                password: { value: '', focus: false, isValid: true },\n                error: null\n            };\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _React$createElement, _React$createElement2, _React$createElement3, _React$createElement4, _React$createElement5, _React$createElement6, _React$createElement7, _React$createElement8, _React$createElement9, _React$createElement10, _React$createElement11;\n\n            var langMap = this.props.langMap;\n            var _state = this.state,\n                isForgetPassword = _state.isForgetPassword,\n                isPasswordShown = _state.isPasswordShown,\n                error = _state.error;\n\n            var text = (0, _propOr2.default)('auth', {}, langMap);\n\n            return [_react2.default.createElement(\n                'form',\n                (_React$createElement10 = { key: 0, className: (0, _classnames2.default)(_AuthFormPopup2.default.form, (0, _defineProperty3.default)({}, _AuthFormPopup2.default.isPopupHidden, isForgetPassword)), onSubmit: this.handleSubmit, 'data-qa-file': 'AuthFormPopup'\n                }, (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement10, 'data-qa-file', 'AuthFormPopup'), _React$createElement10),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement3 = { className: _AuthFormPopup2.default.emailContainerField, 'data-qa-file': 'AuthFormPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement3, 'data-qa-file', 'AuthFormPopup'), _React$createElement3),\n                    _react2.default.createElement(_FormInput2.default, (_React$createElement = {\n                        isError: !this.state['email'].isValid,\n                        texts: { email: '' + text.inputs.email.placeholder, emailValidator: '' + text.inputs.email.validator },\n                        name: 'email',\n                        type: 'email',\n                        onFocus: this.onFocus,\n                        onBlur: this.onBlur,\n                        handleChange: this.handleChange,\n                        value: this.state.email.value,\n                        focus: this.state.email.value,\n                        'data-qa-file': 'AuthFormPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement, 'data-qa-file', 'AuthFormPopup'), _React$createElement)),\n                    _react2.default.createElement(\n                        'div',\n                        (_React$createElement2 = { className: (0, _classnames2.default)(_AuthFormPopup2.default.bottomLabel, (0, _defineProperty3.default)({}, _AuthFormPopup2.default.bottomLabelActive, this.state['email'].isValid)), 'data-qa-file': 'AuthFormPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement2, 'data-qa-file', 'AuthFormPopup'), _React$createElement2),\n                        text.isLogin\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement5 = { className: _AuthFormPopup2.default.passwordContainerField, 'data-qa-file': 'AuthFormPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement5, 'data-qa-file', 'AuthFormPopup'), _React$createElement5),\n                    _react2.default.createElement(_FormInput2.default, (0, _extends3.default)({\n                        isError: !this.state['password'].isValid,\n                        texts: { password: '' + text.inputs.password.placeholder, passwordValidator: '' + text.inputs.password.validator },\n                        name: 'password',\n                        onFocus: this.onFocus,\n                        onBlur: this.onBlur,\n                        handleChange: this.handleChange,\n                        value: this.state.password.value,\n                        focus: this.state.password.focus\n                    }, !isPasswordShown && { type: 'password' }, {\n                        'data-qa-file': 'AuthFormPopup'\n                    })),\n                    _react2.default.createElement('img', (_React$createElement4 = {\n                        onClick: this.handlerShowPassword,\n                        src: '/src/apps/client/ui/components/AuthFormPopup/images/password.svg',\n                        alt: '',\n                        'data-qa-file': 'AuthFormPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement4, 'data-qa-file', 'AuthFormPopup'), _React$createElement4))\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement8 = { className: _AuthFormPopup2.default.buttonContainer, 'data-qa-file': 'AuthFormPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement8, 'data-qa-file', 'AuthFormPopup'), _React$createElement8),\n                    error && _react2.default.createElement(\n                        'div',\n                        (_React$createElement6 = { className: _AuthFormPopup2.default.errorMessage, 'data-qa-file': 'AuthFormPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement6, 'data-qa-file', 'AuthFormPopup'), _React$createElement6),\n                        error\n                    ),\n                    _react2.default.createElement(\n                        'button',\n                        (_React$createElement7 = { className: (0, _classnames2.default)(_AuthFormPopup2.default.button), type: 'submit', 'data-qa-file': 'AuthFormPopup'\n                        }, (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement7, 'data-qa-file', 'AuthFormPopup'), _React$createElement7),\n                        text.signIn\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    (_React$createElement9 = { className: _AuthFormPopup2.default.forgetPassordButton, onClick: this.handleForgetPassword, 'data-qa-file': 'AuthFormPopup'\n                    }, (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement9, 'data-qa-file', 'AuthFormPopup'), _React$createElement9),\n                    text.forgetPassword\n                )\n            ), _react2.default.createElement(_ResetPasswordFormPopup2.default, (_React$createElement11 = { key: 1, isOpen: isForgetPassword, handleBackClick: this.handleForgetPassword, handleClose: this.closePopup, 'data-qa-file': 'AuthFormPopup'\n            }, (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'AuthFormPopup'), (0, _defineProperty3.default)(_React$createElement11, 'data-qa-file', 'AuthFormPopup'), _React$createElement11))];\n        }\n    }]);\n    return AuthFormPopup;\n}(_react.Component);\n\nexports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(AuthFormPopup);",null]}