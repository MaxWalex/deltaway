{"remainingRequest":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/babel-loader/lib/index.js??ref--5-2!/Users/dimasabitov/Downloads/deltaway.20/server/api/admin/authentication/services/changeCredentials.js","dependencies":[{"path":"/Users/dimasabitov/Downloads/deltaway.20/server/api/admin/authentication/services/changeCredentials.js","mtime":1671546368408},{"path":"/Users/dimasabitov/Downloads/deltaway.20/.babelrc","mtime":1671546158632},{"path":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/cache-loader/dist/cjs.js","mtime":1671546959174},{"path":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/babel-loader/lib/index.js","mtime":1671546957682}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = changeCredentials;\n\nvar _md = require('md5');\n\nvar _md2 = _interopRequireDefault(_md);\n\nvar _constants = require('../../../../constants/constants');\n\nvar _getAdminByLogin = require('../queries/getAdminByLogin');\n\nvar _getAdminByLogin2 = _interopRequireDefault(_getAdminByLogin);\n\nvar _changeCredentials = require('../queries/changeCredentials');\n\nvar _changeCredentials2 = _interopRequireDefault(_changeCredentials);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction changeCredentials(req, res) {\n    try {\n        var _req$body = req.body,\n            _req$body$oldCredenti = _req$body.oldCredentials,\n            oldCredentials = _req$body$oldCredenti === undefined ? {} : _req$body$oldCredenti,\n            _req$body$newCredenti = _req$body.newCredentials,\n            newCredentials = _req$body$newCredenti === undefined ? {} : _req$body$newCredenti;\n\n\n        (0, _getAdminByLogin2.default)(oldCredentials.login).then(function (admin) {\n            if (admin.password !== (0, _md2.default)(oldCredentials.password)) {\n                return res.status(_constants.FORBIDDEN_STATUS_CODE).end();\n            }\n\n            (0, _changeCredentials2.default)({\n                login: newCredentials.login,\n                password: (0, _md2.default)(newCredentials.password),\n                email: newCredentials.email,\n                id: admin.id\n            }).then(function () {\n                res.status(_constants.OKEY_STATUS_CODE).end();\n            }).catch(function () {\n                res.status(_constants.SERVER_ERROR_STATUS_CODE).end();\n            });\n        }).catch(function () {\n            res.status(_constants.FORBIDDEN_STATUS_CODE).end();\n        });\n    } catch (e) {\n        res.status(_constants.SERVER_ERROR_STATUS_CODE).end();\n    }\n}\nchangeCredentials.i = 'changeCredentials';\nchangeCredentials.i = 'changeCredentials';",null]}