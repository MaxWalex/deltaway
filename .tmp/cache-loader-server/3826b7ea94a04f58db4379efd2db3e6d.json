{"remainingRequest":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js??ref--5-2!C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\server\\controllers\\pricesWebsocketController.js","dependencies":[{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\server\\controllers\\pricesWebsocketController.js","mtime":1671546362000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\.babelrc","mtime":1671546158000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1671546958000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js","mtime":1671546956000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _socket = require('socket.io');\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _constants = require('../constants/constants');\n\nvar _pricesController = require('../controllers/pricesController');\n\nvar _https = require('https');\n\nvar _https2 = _interopRequireDefault(_https);\n\nvar _http = require('http');\n\nvar _http2 = _interopRequireDefault(_http);\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _express = require('express');\n\nvar _express2 = _interopRequireDefault(_express);\n\nvar _worker_threads = require('worker_threads');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar credentials = {\n    key: _fs2.default.readFileSync('server/https/private-new.key'),\n    cert: _fs2.default.readFileSync('server/https/certificate.crt'),\n    ca: []\n};\n\nvar PricesWebsocketController = function () {\n    function PricesWebsocketController() {\n        (0, _classCallCheck3.default)(this, PricesWebsocketController);\n\n        if (_worker_threads.isMainThread) {\n            var app = (0, _express2.default)();\n\n            var server = process.env.NODE_ENV === 'production' ? _https2.default.createServer(credentials, app) : _http2.default.createServer(app);\n\n            server.listen(8443, function () {});\n\n            this.io = (0, _socket2.default)(server);\n        }\n    }\n\n    (0, _createClass3.default)(PricesWebsocketController, [{\n        key: 'start',\n        value: function start() {\n            this.io.on('connection', function (client) {\n                _pricesController.pricesEvents.on(_constants.SYMBOL_PRICE_CHANGE_EVENT, function (data) {\n                    client.emit('message', data.assetPriceChange);\n                });\n            });\n        }\n    }]);\n    return PricesWebsocketController;\n}();\n\nvar pricesWebsocketController = new PricesWebsocketController();\n\nexports.default = pricesWebsocketController;",null]}