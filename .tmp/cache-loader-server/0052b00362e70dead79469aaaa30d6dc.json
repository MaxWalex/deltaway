{"remainingRequest":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js??ref--5-2!C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\server\\api\\client\\user\\services\\removeDoc.js","dependencies":[{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\server\\api\\client\\user\\services\\removeDoc.js","mtime":1671546376000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\.babelrc","mtime":1671546158000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1671546958000},{"path":"C:\\Users\\cherv\\OneDrive\\Рабочий стол\\deltaway.20\\node_modules\\babel-loader\\lib\\index.js","mtime":1671546956000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends3 = require('babel-runtime/helpers/extends');\n\nvar _extends4 = _interopRequireDefault(_extends3);\n\nexports.default = removeDoc;\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _constants = require('../../../../constants/constants');\n\nvar _editUser = require('../queries/editUser');\n\nvar _editUser2 = _interopRequireDefault(_editUser);\n\nvar _includes = require('@tinkoff/utils/array/includes');\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction removeDoc(req, res) {\n    try {\n        var docName = req.body.docName;\n        var id = res.locals.user.id;\n\n\n        if (!(0, _includes2.default)(docName, _constants.DOC_NAMES)) {\n            return res.status(_constants.BAD_REQUEST_STATUS_CODE).end();\n        }\n\n        var oldDoc = res.locals.user.docs[docName];\n\n        if (!oldDoc) {\n            return res.status(_constants.BAD_REQUEST_STATUS_CODE).end();\n        }\n\n        (0, _editUser2.default)({\n            id: id,\n            docs: (0, _extends4.default)({}, res.locals.user.docs, (0, _defineProperty3.default)({}, docName, null)),\n            updatedAt: Date.now()\n        }).then(function (user) {\n            var oldDocPathFs = _path2.default.join(__dirname, '..', oldDoc.path);\n\n            _fs2.default.unlinkSync(oldDocPathFs);\n            return res.status(_constants.OKEY_STATUS_CODE).send({\n                user: user\n            });\n        }).catch(function () {\n            res.status(_constants.SERVER_ERROR_STATUS_CODE).end();\n        });\n    } catch (e) {\n        res.status(_constants.SERVER_ERROR_STATUS_CODE).end();\n    }\n}\nremoveDoc.i = 'removeDoc';\nremoveDoc.i = 'removeDoc';",null]}