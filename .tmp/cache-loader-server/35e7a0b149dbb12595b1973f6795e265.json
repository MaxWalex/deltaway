{"remainingRequest":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/babel-loader/lib/index.js??ref--5-2!/Users/dimasabitov/Downloads/deltaway.20/server/api/admin/files/services/upload.js","dependencies":[{"path":"/Users/dimasabitov/Downloads/deltaway.20/server/api/admin/files/services/upload.js","mtime":1671546375105},{"path":"/Users/dimasabitov/Downloads/deltaway.20/.babelrc","mtime":1671546158632},{"path":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/cache-loader/dist/cjs.js","mtime":1671546959174},{"path":"/Users/dimasabitov/Downloads/deltaway.20/node_modules/babel-loader/lib/index.js","mtime":1671546957682}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = updateAvatar;\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _uniqid = require('uniqid');\n\nvar _uniqid2 = _interopRequireDefault(_uniqid);\n\nvar _constants = require('../../../../constants/constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction updateAvatar(req, res) {\n    try {\n        var _req$body = req.body,\n            dirName = _req$body.dirName,\n            name = _req$body.name,\n            data = _req$body.data;\n\n        var fileNameParse = _path2.default.parse(name);\n        var file = data.split(';base64,').pop();\n\n        if (!_fs2.default.existsSync(_constants.FILES_FOLDER_PATH)) {\n            _fs2.default.mkdirSync(_constants.FILES_FOLDER_PATH);\n        }\n\n        var dir = _path2.default.resolve(_constants.FILES_FOLDER_PATH, dirName);\n        var isDirExists = _fs2.default.existsSync(dir);\n\n        if (!isDirExists) {\n            _fs2.default.mkdirSync(dir);\n        }\n\n        var resultFileName = fileNameParse.name + '-' + (0, _uniqid2.default)() + fileNameParse.ext;\n\n        _fs2.default.writeFileSync(_path2.default.resolve(dir, resultFileName), file, { encoding: 'base64' });\n\n        res.status(_constants.OKEY_STATUS_CODE).send('/' + _constants.FILES_FOLDER_PATH + '/' + dirName + '/' + resultFileName);\n    } catch (e) {\n        return res.status(_constants.SERVER_ERROR_STATUS_CODE).end();\n    }\n}\nupdateAvatar.i = 'updateAvatar';\nupdateAvatar.i = 'updateAvatar';",null]}